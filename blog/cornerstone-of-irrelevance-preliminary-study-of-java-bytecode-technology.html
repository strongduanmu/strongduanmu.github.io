<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="hexo-theme" content="https://github.com/xaoxuu/hexo-theme-stellar/tree/1.30.1" theme-name="Stellar" theme-version="1.30.1"><meta name="generator" content="Hexo 7.3.0"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="preconnect" href="https://pagead2.googlesyndication.com" crossorigin><link rel="preconnect" href="https://googleads.g.doubleclick.net" crossorigin><meta name="renderer" content="webkit"><meta name="force-rendering" content="webkit"><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><meta name="HandheldFriendly" content="True"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000"><meta name="theme-color" content="#f9fafb"><title>æ— å…³æ€§çš„åŸºçŸ³ä¹‹ Java å­—èŠ‚ç æŠ€æœ¯åˆæ¢ - ç«¯å°å¼ºçš„åšå®¢</title><meta name="description" content="å‰è¨€ ç†Ÿæ‚‰ Java è¯­è¨€çš„æœ‹å‹åº”è¯¥éƒ½å¬è¿‡ Write Once, Run Anywhere. è¿™æ ·çš„å£å·ï¼Œå®ƒä¸»è¦é˜è¿°åœ°æ˜¯ Java è¯­è¨€çš„è·¨å¹³å°ç‰¹æ€§ã€‚å·¥ç¨‹å¸ˆåªéœ€è¦ç¼–å†™ä¸€æ¬¡ Java æºç ï¼Œå†é€šè¿‡ Java ç¼–è¯‘å™¨å°†æºç ç¼–è¯‘ä¸ºå­—èŠ‚ç æ–‡ä»¶ï¼Œå°±å¯ä»¥å¾ˆæ–¹ä¾¿åœ°åœ¨ä¸åŒæ“ä½œç³»ç»Ÿçš„ JVM ä¸Šè¿›è¡Œåˆ†å‘è¿è¡Œã€‚Java å­—èŠ‚ç æŠ€æœ¯æ˜¯ Java è¯­è¨€å®ç°å¹³å°æ— å…³æ€§çš„åŸºçŸ³ï¼Œä¹Ÿæ˜¯å­¦ä¹  JVM è™šæ‹Ÿæœºå®ç°çš„åŸºç¡€ï¼Œäº†è§£ J"><meta property="og:type" content="article"><meta property="og:title" content="æ— å…³æ€§çš„åŸºçŸ³ä¹‹ Java å­—èŠ‚ç æŠ€æœ¯åˆæ¢"><meta property="og:url" content="https://strongduanmu.com/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology.html"><meta property="og:site_name" content="ç«¯å°å¼ºçš„åšå®¢"><meta property="og:description" content="å‰è¨€ ç†Ÿæ‚‰ Java è¯­è¨€çš„æœ‹å‹åº”è¯¥éƒ½å¬è¿‡ Write Once, Run Anywhere. è¿™æ ·çš„å£å·ï¼Œå®ƒä¸»è¦é˜è¿°åœ°æ˜¯ Java è¯­è¨€çš„è·¨å¹³å°ç‰¹æ€§ã€‚å·¥ç¨‹å¸ˆåªéœ€è¦ç¼–å†™ä¸€æ¬¡ Java æºç ï¼Œå†é€šè¿‡ Java ç¼–è¯‘å™¨å°†æºç ç¼–è¯‘ä¸ºå­—èŠ‚ç æ–‡ä»¶ï¼Œå°±å¯ä»¥å¾ˆæ–¹ä¾¿åœ°åœ¨ä¸åŒæ“ä½œç³»ç»Ÿçš„ JVM ä¸Šè¿›è¡Œåˆ†å‘è¿è¡Œã€‚Java å­—èŠ‚ç æŠ€æœ¯æ˜¯ Java è¯­è¨€å®ç°å¹³å°æ— å…³æ€§çš„åŸºçŸ³ï¼Œä¹Ÿæ˜¯å­¦ä¹  JVM è™šæ‹Ÿæœºå®ç°çš„åŸºç¡€ï¼Œäº†è§£ J"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://strongduanmu.com/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology/show-bytecode-with-jclasslib.png"><meta property="og:image" content="https://strongduanmu.com/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology/jclasslib-bytecode-view.png"><meta property="og:image" content="https://strongduanmu.com/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology/local-variable-and-stack-relationship.png"><meta property="og:image" content="https://strongduanmu.com/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology/class-bytecode.png"><meta property="og:image" content="https://strongduanmu.com/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology/hello-byte-code-class.png"><meta property="og:image" content="https://strongduanmu.com/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology/bytecode-execute-progress-bipush-100.png"><meta property="og:image" content="https://strongduanmu.com/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology/bytecode-execute-progress-istore_1.png"><meta property="og:image" content="https://strongduanmu.com/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology/bytecode-execute-progress-sipush-200.png"><meta property="og:image" content="https://strongduanmu.com/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology/bytecode-execute-progress-istore_2.png"><meta property="og:image" content="https://strongduanmu.com/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology/bytecode-execute-progress-sipush-300.png"><meta property="og:image" content="https://strongduanmu.com/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology/bytecode-execute-progress-istore_3.png"><meta property="og:image" content="https://strongduanmu.com/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology/bytecode-execute-progress-iload_1.png"><meta property="og:image" content="https://strongduanmu.com/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology/bytecode-execute-progress-iload_2.png"><meta property="og:image" content="https://strongduanmu.com/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology/bytecode-execute-progress-iadd.png"><meta property="og:image" content="https://strongduanmu.com/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology/bytecode-execute-progress-iload_3.png"><meta property="og:image" content="https://strongduanmu.com/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology/bytecode-execute-progress-imul.png"><meta property="og:image" content="https://strongduanmu.com/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology/bytecode-execute-progress-ireturn.png"><meta property="og:image" content="https://strongduanmu.com/assets/wechat/gongzhonghao.png"><meta property="article:published_time" content="2024-07-25T23:30:00.000Z"><meta property="article:modified_time" content="2024-08-03T23:30:00.000Z"><meta property="article:author" content="ç«¯å°å¼º"><meta property="article:tag" content="JVM"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://strongduanmu.com/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology/show-bytecode-with-jclasslib.png"><meta name="twitter:creator" content="@strongduanmu"><meta name="keywords" content="JVM"><link rel="alternate" href="/atom.xml" title="ç«¯å°å¼ºçš„åšå®¢" type="application/atom+xml"><link rel="stylesheet" href="/css/main.css?v=1.30.1"><link rel="shortcut icon" href="/assets/placeholder/favicon.ico"><meta name="baidu-site-verification" content="codeva-sIRwgTpHve"><link rel="apple-touch-icon" sizes="180x180" href="/assets/placeholder/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/placeholder/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/placeholder/favicon-16x16.png"><link rel="manifest" href="/assets/placeholder/site.webmanifest"><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="/css/lxgwwenkaimono-bold.css" media="print" onload='this.media="all"'><noscript><link rel="stylesheet" href="/css/lxgwwenkaimono-bold.css"></noscript><link rel="stylesheet" href="/css/lxgwwenkaiscreen.css" media="print" onload='this.media="all"'><noscript><link rel="stylesheet" href="/css/lxgwwenkaiscreen.css"></noscript><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="preconnect" href="https://pagead2.googlesyndication.com"><link rel="dns-prefetch" href="https://pagead2.googlesyndication.com"><script src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9880881761323734" crossorigin="anonymous"></script><script src="/js/plugins/article-bottom-ad.js"></script><script src="/js/plugins/sticky-adsense.js"></script><script src="/js/plugins/adblock-detector.js"></script><style>.widget-wrapper.adsense{background:0 0!important}.widget-wrapper.adsense .widget-body{padding:0!important;background:0 0!important}.widget-wrapper.adsense .widget-body p{margin:0!important}.widget-wrapper.adsense ins.adsbygoogle{display:block;border-radius:12px;overflow:hidden}.article-bottom-ad{margin:2rem 0;padding:1rem;text-align:center}.article-bottom-ad .ad-container{max-width:100%;margin:0 auto}.article-bottom-ad ins.adsbygoogle{display:block;background:0 0}</style></head><body><div class="l_body content tech" id="start" layout="post"><aside class="l_left"><div class="leftbar-container"><header class="header"><div class="logo-wrap"><a class="avatar" href="/more/"><div class="bg" style="opacity:0;background-image:url(/assets/placeholder/rainbow64@3x.webp)"></div><img no-lazy class="avatar" src="/assets/placeholder/avatar.png" onerror="javascript:this.classList.add('error');this.src='/assets/placeholder/image.svg';"></a><a class="title" href="/"><div class="main" ff="title">ç«¯å°å¼ºçš„åšå®¢</div><div class="sub normal cap">ä¸ç§¯è·¬æ­¥ï¼Œæ— ä»¥è‡³åƒé‡Œ ğŸ¤”</div><div class="sub hover cap" style="opacity:0">ä¸ç§¯å°æµï¼Œæ— ä»¥æˆæ±Ÿæµ· ğŸ˜ƒ</div></a></div></header><div class="nav-area"><div class="search-wrapper" id="search-wrapper"><form class="search-form"><a class="search-button" onclick="document.getElementById(&quot;search-input&quot;).focus();"><svg t="1705074644177" viewBox="0 0 1025 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1560" width="200" height="200"><path d="M1008.839137 935.96571L792.364903 719.491476a56.783488 56.783488 0 0 0-80.152866 0 358.53545 358.53545 0 1 1 100.857314-335.166073 362.840335 362.840335 0 0 1-3.689902 170.145468 51.248635 51.248635 0 1 0 99.217358 26.444296 462.057693 462.057693 0 1 0-158.255785 242.303546l185.930047 185.725053a51.248635 51.248635 0 0 0 72.568068 0 51.248635 51.248635 0 0 0 0-72.978056z" p-id="1561"></path><path d="M616.479587 615.969233a50.428657 50.428657 0 0 0-61.498362-5.534852 174.655348 174.655348 0 0 1-177.525271 3.484907 49.403684 49.403684 0 0 0-58.833433 6.76482l-3.074918 2.869923a49.403684 49.403684 0 0 0 8.609771 78.10292 277.767601 277.767601 0 0 0 286.992355-5.739847 49.403684 49.403684 0 0 0 8.404776-76.667958z" p-id="1562"></path></svg></a><input type="text" class="search-input" id="search-input" placeholder="ç«™å†…æœç´¢"></form><div id="search-result"></div><div class="search-no-result">æ²¡æœ‰æ‰¾åˆ°å†…å®¹ï¼</div></div><nav class="menu dis-select"><a class="nav-item active" title="åšå®¢" href="/"><span>åšå®¢</span></a><a class="nav-item" title="æ–‡æ¡£" href="/wiki/"><span>æ–‡æ¡£</span></a><a class="nav-item" title="ä¾¿ç¬º" href="/notes/"><span>ä¾¿ç¬º</span></a><a class="nav-item" title="æ›´å¤š" href="/more/"><span>æ›´å¤š</span></a></nav></div><div class="widgets"><widget class="widget-wrapper toc" id="data-toc" collapse="false"><div class="widget-header dis-select"><span class="name">æœ¬æ–‡ç›®å½•</span><a class="cap-action" onclick="sidebar.toggleTOC()"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6h11m-11 6h11m-11 6h11M4 6h1v4m-1 0h2m0 8H4c0-1 2-2 2-3s-1-1.5-2-1"/></svg></a></div><div class="widget-body"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-text">å‰è¨€</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%AD%97%E8%8A%82%E7%A0%81"><span class="toc-text">ä»€ä¹ˆæ˜¯å­—èŠ‚ç </span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E6%9F%A5%E7%9C%8B%E5%AD%97%E8%8A%82%E7%A0%81"><span class="toc-text">å¦‚ä½•æŸ¥çœ‹å­—èŠ‚ç </span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E8%BF%87-javap-%E5%91%BD%E4%BB%A4%E6%9F%A5%E7%9C%8B"><span class="toc-text">é€šè¿‡ javap å‘½ä»¤æŸ¥çœ‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E8%BF%87-jclasslib-%E6%9F%A5%E7%9C%8B"><span class="toc-text">é€šè¿‡ jclasslib æŸ¥çœ‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E5%AD%97%E8%8A%82%E7%A0%81"><span class="toc-text">æ·±å…¥ç†è§£å­—èŠ‚ç </span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#classfile"><span class="toc-text">Classfile</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#class-%E5%9F%BA%E7%A1%80%E4%BF%A1%E6%81%AF"><span class="toc-text">Class åŸºç¡€ä¿¡æ¯</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E9%87%8F%E6%B1%A0"><span class="toc-text">å¸¸é‡æ± </span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E8%8A%82%E7%A0%81"><span class="toc-text">å­—èŠ‚ç </span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#hellobytecode-%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95"><span class="toc-text">HelloByteCode æ„é€ æ–¹æ³•</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#main-%E6%96%B9%E6%B3%95"><span class="toc-text">main æ–¹æ³•</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sayhello-%E6%96%B9%E6%B3%95"><span class="toc-text">sayHello æ–¹æ³•</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sourcefile"><span class="toc-text">SourceFile</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E8%8A%82%E7%A0%81%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B"><span class="toc-text">å­—èŠ‚ç æ‰§è¡Œè¿‡ç¨‹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%BD%E8%B1%A1%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B"><span class="toc-text">æŠ½è±¡æ‰§è¡Œæµç¨‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B%E8%AF%B4%E6%98%8E"><span class="toc-text">æ‰§è¡Œæµç¨‹è¯´æ˜</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%AD%97%E8%8A%82%E7%A0%81%E6%8C%87%E4%BB%A4"><span class="toc-text">å¸¸ç”¨å­—èŠ‚ç æŒ‡ä»¤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E8%B1%A1%E5%88%9D%E5%A7%8B%E5%8C%96%E6%8C%87%E4%BB%A4"><span class="toc-text">å¯¹è±¡åˆå§‹åŒ–æŒ‡ä»¤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%88%E6%93%8D%E4%BD%9C%E6%8C%87%E4%BB%A4"><span class="toc-text">æ ˆæ“ä½œæŒ‡ä»¤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6%E6%8C%87%E4%BB%A4"><span class="toc-text">æµç¨‹æ§åˆ¶æŒ‡ä»¤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E8%B0%83%E7%94%A8%E6%8C%87%E4%BB%A4"><span class="toc-text">æ–¹æ³•è°ƒç”¨æŒ‡ä»¤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97%E5%8F%8A%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2%E6%8C%87%E4%BB%A4"><span class="toc-text">ç®—æœ¯è¿ç®—åŠç±»å‹è½¬æ¢æŒ‡ä»¤</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E8%AF%AD"><span class="toc-text">ç»“è¯­</span></a></li></ol></div><div class="widget-footer"><a class="top" onclick="util.scrollTop()"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="1.5"><path d="M2 12c0-4.714 0-7.071 1.464-8.536C4.93 2 7.286 2 12 2c4.714 0 7.071 0 8.535 1.464C22 4.93 22 7.286 22 12c0 4.714 0 7.071-1.465 8.535C19.072 22 16.714 22 12 22s-7.071 0-8.536-1.465C2 19.072 2 16.714 2 12Z"/><path stroke-linecap="round" stroke-linejoin="round" d="m9 15.5l3-3l3 3m-6-4l3-3l3 3"/></g></svg><span>å›åˆ°é¡¶éƒ¨</span></a><a class="buttom" onclick="util.scrollComment()"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M10.46 1.25h3.08c1.603 0 2.86 0 3.864.095c1.023.098 1.861.3 2.6.752a5.75 5.75 0 0 1 1.899 1.899c.452.738.654 1.577.752 2.6c.095 1.004.095 2.261.095 3.865v1.067c0 1.141 0 2.036-.05 2.759c-.05.735-.153 1.347-.388 1.913a5.75 5.75 0 0 1-3.112 3.112c-.805.334-1.721.408-2.977.43a10.81 10.81 0 0 0-.929.036c-.198.022-.275.054-.32.08c-.047.028-.112.078-.224.232c-.121.166-.258.396-.476.764l-.542.916c-.773 1.307-2.69 1.307-3.464 0l-.542-.916a10.605 10.605 0 0 0-.476-.764c-.112-.154-.177-.204-.224-.232c-.045-.026-.122-.058-.32-.08c-.212-.023-.49-.03-.93-.037c-1.255-.021-2.171-.095-2.976-.429A5.75 5.75 0 0 1 1.688 16.2c-.235-.566-.338-1.178-.389-1.913c-.049-.723-.049-1.618-.049-2.76v-1.066c0-1.604 0-2.86.095-3.865c.098-1.023.3-1.862.752-2.6a5.75 5.75 0 0 1 1.899-1.899c.738-.452 1.577-.654 2.6-.752C7.6 1.25 8.857 1.25 10.461 1.25M6.739 2.839c-.914.087-1.495.253-1.959.537A4.25 4.25 0 0 0 3.376 4.78c-.284.464-.45 1.045-.537 1.96c-.088.924-.089 2.11-.089 3.761v1c0 1.175 0 2.019.046 2.685c.045.659.131 1.089.278 1.441a4.25 4.25 0 0 0 2.3 2.3c.515.214 1.173.294 2.429.316h.031c.398.007.747.013 1.037.045c.311.035.616.104.909.274c.29.17.5.395.682.645c.169.232.342.525.538.856l.559.944a.52.52 0 0 0 .882 0l.559-.944c.196-.331.37-.624.538-.856c.182-.25.392-.476.682-.645c.293-.17.598-.24.909-.274c.29-.032.639-.038 1.037-.045h.032c1.255-.022 1.913-.102 2.428-.316a4.25 4.25 0 0 0 2.3-2.3c.147-.352.233-.782.278-1.441c.046-.666.046-1.51.046-2.685v-1c0-1.651 0-2.837-.089-3.762c-.087-.914-.253-1.495-.537-1.959a4.25 4.25 0 0 0-1.403-1.403c-.464-.284-1.045-.45-1.96-.537c-.924-.088-2.11-.089-3.761-.089h-3c-1.651 0-2.837 0-3.762.089" clip-rule="evenodd"/><path fill="currentColor" d="M9 11a1 1 0 1 1-2 0a1 1 0 0 1 2 0m4 0a1 1 0 1 1-2 0a1 1 0 0 1 2 0m4 0a1 1 0 1 1-2 0a1 1 0 0 1 2 0"/></svg><span>å‚ä¸è®¨è®º</span></a></div></widget><widget class="widget-wrapper post-list"><div class="widget-header dis-select"><span class="name">ä¸“æ ï¼šJVM</span></div><div class="widget-body"><a class="item" href="/blog/graalvm-compilation-of-dynamic-link-library-mysql-udf-implementation.html"><span class="title">GraalVM ç¼–è¯‘åŠ¨æ€é“¾æ¥åº“ä¹‹ MySQL UDF å®ç°</span></a><a class="item" href="/blog/java-aot-compiler-framework-graalvm-quick-start.html"><span class="title">Java AOT ç¼–è¯‘æ¡†æ¶ GraalVM å¿«é€Ÿå…¥é—¨</span></a><a class="item active" href="/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology.html"><span class="title">æ— å…³æ€§çš„åŸºçŸ³ä¹‹ Java å­—èŠ‚ç æŠ€æœ¯åˆæ¢</span><svg class="active-icon" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="M21 11.098v4.993c0 3.096 0 4.645-.734 5.321c-.35.323-.792.526-1.263.58c-.987.113-2.14-.907-4.445-2.946c-1.02-.901-1.529-1.352-2.118-1.47a2.225 2.225 0 0 0-.88 0c-.59.118-1.099.569-2.118 1.47c-2.305 2.039-3.458 3.059-4.445 2.945a2.238 2.238 0 0 1-1.263-.579C3 20.736 3 19.188 3 16.091v-4.994C3 6.81 3 4.666 4.318 3.333C5.636 2 7.758 2 12 2c4.243 0 6.364 0 7.682 1.332C21 4.665 21 6.81 21 11.098" opacity=".5"/><path fill="currentColor" d="M9 5.25a.75.75 0 0 0 0 1.5h6a.75.75 0 0 0 0-1.5z"/></svg></a><a class="item" href="/blog/opcode-mnemonics-by-opcode.html"><span class="title">Java è™šæ‹ŸæœºæŒ‡ä»¤æ“ä½œç å’ŒåŠ©è®°ç¬¦æ˜ å°„å…³ç³»</span></a><a class="item" href="/blog/jvm-learning-materials.html"><span class="title">JVM å­¦ä¹ èµ„æ–™æ•´ç†</span></a></div></widget></div><footer class="footer dis-select"><div class="social-wrap"><a class="social" href="mailto:duanzhengqiang@apache.org" rel="noopener noreferrer"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/assets/placeholder/email.svg"></a><a class="social" href="https://github.com/strongduanmu" target="_blank" rel="external nofollow noopener noreferrer"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/assets/placeholder/github.svg"></a><a class="social" href="/sitemap.xml" rel="noopener noreferrer"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/assets/placeholder/sitemap.svg"></a><a class="social" href="/atom.xml" rel="noopener noreferrer"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/assets/placeholder/rss.svg"></a></div></footer></div></aside><div class="l_main" id="main"><div class="article banner top"><img class="bg lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/assets/banner/banner_3.jpg"><div class="content"><div class="top bread-nav footnote"><div class="left"><div class="flex-row" id="breadcrumb"><a class="cap breadcrumb" href="/">ä¸»é¡µ</a> <span class="sep"></span><a class="cap breadcrumb" id="menu" href="/topic">ä¸“æ </a><span class="sep"></span><a class="cap breadcrumb" id="proj" href="/blog/graalvm-compilation-of-dynamic-link-library-mysql-udf-implementation.html">JVM</a></div><div class="flex-row" id="post-meta"><span class="text created">å‘å¸ƒäºï¼š<time datetime="2024-07-25T23:30:00.000Z">2024-07-26</time></span><span class="sep updated"></span><span class="text updated">æ›´æ–°äºï¼š<time datetime="2024-08-03T23:30:00.000Z">2024-08-04</time></span></div></div></div><div class="bottom only-title"><div class="text-area"><h1 class="text title"><span>æ— å…³æ€§çš„åŸºçŸ³ä¹‹ Java å­—èŠ‚ç æŠ€æœ¯åˆæ¢</span></h1></div></div></div></div><article class="md-text content"><h2 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h2><p>ç†Ÿæ‚‰ Java è¯­è¨€çš„æœ‹å‹åº”è¯¥éƒ½å¬è¿‡ <code>Write Once, Run Anywhere.</code> è¿™æ ·çš„å£å·ï¼Œå®ƒä¸»è¦é˜è¿°åœ°æ˜¯ Java è¯­è¨€çš„è·¨å¹³å°ç‰¹æ€§ã€‚å·¥ç¨‹å¸ˆåªéœ€è¦ç¼–å†™ä¸€æ¬¡ Java æºç ï¼Œå†é€šè¿‡ Java ç¼–è¯‘å™¨å°†æºç ç¼–è¯‘ä¸ºå­—èŠ‚ç æ–‡ä»¶ï¼Œå°±å¯ä»¥å¾ˆæ–¹ä¾¿åœ°åœ¨ä¸åŒæ“ä½œç³»ç»Ÿçš„ JVM ä¸Šè¿›è¡Œåˆ†å‘è¿è¡Œã€‚<strong>Java å­—èŠ‚ç æŠ€æœ¯æ˜¯ Java è¯­è¨€å®ç°å¹³å°æ— å…³æ€§çš„åŸºçŸ³ï¼Œä¹Ÿæ˜¯å­¦ä¹  JVM è™šæ‹Ÿæœºå®ç°çš„åŸºç¡€</strong>ï¼Œäº†è§£ Java å­—èŠ‚ç æŠ€æœ¯ï¼Œå¯ä»¥å¸®åŠ©å¤§å®¶ç†è§£åç»­çš„ç±»åŠ è½½æœºåˆ¶ï¼Œä»¥åŠ JVM ç¼–è¯‘ä¼˜åŒ–ç›¸å…³çš„å†…å®¹ã€‚å› æ­¤ï¼Œæœ¬ç³»åˆ—é¦–å…ˆä» Java å­—èŠ‚ç æŠ€æœ¯å¼€å§‹ï¼Œå’Œå¤§å®¶ä¸€èµ·åˆæ­¥æ¢ç©¶å­—èŠ‚ç çš„è®¾è®¡å’Œæ‰§è¡Œé€»è¾‘ã€‚</p><h2 id="ä»€ä¹ˆæ˜¯å­—èŠ‚ç "><a class="markdownIt-Anchor" href="#ä»€ä¹ˆæ˜¯å­—èŠ‚ç "></a> ä»€ä¹ˆæ˜¯å­—èŠ‚ç </h2><p>å­—èŠ‚ç å³ <code>Java ByteCode</code>ï¼Œå®ƒç”±å•ä¸ªå­—èŠ‚ï¼ˆ<code>byte</code>ï¼‰çš„æŒ‡ä»¤ç»„æˆï¼Œç†è®ºä¸Šæœ€å¤šå¯ä»¥æ”¯æŒ 256 ä¸ªæ“ä½œç ï¼ˆ<code>opcode</code>ï¼‰ï¼Œè€Œå®é™…ä¸Š Java åªä½¿ç”¨äº† 200 å·¦å³çš„æ“ä½œç ï¼Œè¿˜æœ‰ä¸€äº›æ“ä½œç åˆ™ä¿ç•™ä¸‹æ¥ï¼Œç”¨äºè°ƒè¯•ç­‰æ“ä½œã€‚æ“ä½œç é€šå¸¸ä¹Ÿç§°ä¸ºæŒ‡ä»¤ï¼Œåé¢ä¼šè·Ÿéšé›¶è‡³å¤šä¸ªå‚æ•°ï¼Œå³æ“ä½œæ•°ï¼ˆ<code>operand</code>ï¼‰ã€‚æ ¹æ®æŒ‡ä»¤çš„ç‰¹æ€§ï¼Œå¯ä»¥å°†å­—èŠ‚ç åˆ†ä¸ºå¦‚ä¸‹çš„ 4 å¤§ç±»ï¼š</p><ol><li><strong>æ ˆæ“ä½œæŒ‡ä»¤</strong>ï¼ŒåŒ…æ‹¬ä¸å±€éƒ¨å˜é‡äº¤äº’çš„æŒ‡ä»¤ï¼›</li><li><strong>æµç¨‹æ§åˆ¶æŒ‡ä»¤</strong>ï¼›</li><li><strong>æ–¹æ³•è°ƒç”¨æŒ‡ä»¤</strong>ï¼›</li><li><strong>ç®—æœ¯è¿ç®—åŠç±»å‹è½¬æ¢æŒ‡ä»¤</strong>ã€‚</li></ol><p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€äº›ç”¨äºæ‰§è¡Œä¸“é—¨ä»»åŠ¡çš„æŒ‡ä»¤ï¼Œä¾‹å¦‚<strong>åŒæ­¥æŒ‡ä»¤ã€å¼‚å¸¸æŒ‡ä»¤</strong>ç­‰ï¼Œå®Œæ•´çš„ JVM æŒ‡ä»¤å¯ä»¥å‚è€ƒ <a href="https://strongduanmu.com/blog/opcode-mnemonics-by-opcode.html">Java è™šæ‹ŸæœºæŒ‡ä»¤æ“ä½œç å’ŒåŠ©è®°ç¬¦æ˜ å°„å…³ç³»</a>ã€‚</p><div class="article-inline-ad-wrapper"><div class="article-inline-ad-container"><ins class="adsbygoogle" style="display:block;text-align:center" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-9880881761323734" data-ad-slot="7617691942"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><div class="article-inline-ad-label">èµåŠ©å•†</div></div><h2 id="å¦‚ä½•æŸ¥çœ‹å­—èŠ‚ç "><a class="markdownIt-Anchor" href="#å¦‚ä½•æŸ¥çœ‹å­—èŠ‚ç "></a> å¦‚ä½•æŸ¥çœ‹å­—èŠ‚ç </h2><h3 id="é€šè¿‡-javap-å‘½ä»¤æŸ¥çœ‹"><a class="markdownIt-Anchor" href="#é€šè¿‡-javap-å‘½ä»¤æŸ¥çœ‹"></a> é€šè¿‡ <code>javap</code> å‘½ä»¤æŸ¥çœ‹</h3><p>JDK å·¥å…·è‡ªå¸¦äº† <code>javap</code> å‘½ä»¤ï¼Œå¯ä»¥ç”¨äºæŸ¥çœ‹ class æ–‡ä»¶ä¸­çš„å­—èŠ‚ç ï¼Œæ‰§è¡Œ <code>javap -h</code> å¯ä»¥æŸ¥çœ‹è¯¥å‘½ä»¤è¯¦ç»†çš„ä½¿ç”¨è¯´æ˜ã€‚ç”¨æˆ·ä½¿ç”¨ <code>javap</code> å‘½ä»¤æ—¶ï¼Œéœ€è¦åœ¨åé¢æŒ‡å®šå‚æ•°ä»¥åŠ class å­—èŠ‚ç æ–‡ä»¶åï¼Œå¸¸ç”¨çš„å‚æ•°æœ‰ <code>-c</code> å’Œ <code>-v</code> ï¼Œ<code>-c</code> å‚æ•°ç”¨äºå¯¹ä»£ç è¿›è¡Œåç¼–è¯‘ï¼Œå¯ä»¥æŸ¥çœ‹ class æ–‡ä»¶ä¸­çš„å­—èŠ‚ç ä¿¡æ¯ï¼Œ<code>-v</code> å‚æ•°åˆ™ç”¨äºæ‰“å°é™„åŠ ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼š<code>constant pool</code> å¸¸é‡æ± ä¿¡æ¯ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">â¯ javap -h</span><br><span class="line">Usage: javap &lt;options&gt; &lt;classes&gt;</span><br><span class="line"><span class="built_in">where</span> possible options include:</span><br><span class="line">  -? -h --<span class="built_in">help</span> -<span class="built_in">help</span>               Print this <span class="built_in">help</span> message <span class="comment"># æ‰“å°å¸®åŠ©ä¿¡æ¯</span></span><br><span class="line">  -version                         Version information <span class="comment"># ç‰ˆæœ¬ä¿¡æ¯</span></span><br><span class="line">  -v  -verbose                     Print additional information <span class="comment"># æ‰“å°é™„åŠ ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼šconstant pool å¸¸é‡æ± ä¿¡æ¯</span></span><br><span class="line">  -l                               Print line number and <span class="built_in">local</span> variable tables <span class="comment"># æ‰“å°è¡Œå·å’Œæœ¬åœ°å˜é‡è¡¨</span></span><br><span class="line">  -public                          Show only public classes and members <span class="comment"># ä»…æ˜¾ç¤º public ç±»å’Œæˆå‘˜</span></span><br><span class="line">  -protected                       Show protected/public classes and members <span class="comment"># æ˜¾ç¤º protected/public ç±»å’Œæˆå‘˜</span></span><br><span class="line">  -package                         Show package/protected/public classes </span><br><span class="line">                                   and members (default) <span class="comment"># æ˜¾ç¤º package/protected/public ç±»å’Œæˆå‘˜ï¼ˆé»˜è®¤ï¼‰</span></span><br><span class="line">  -p  -private                     Show all classes and members <span class="comment"># æ˜¾ç¤ºæ‰€æœ‰ç±»å’Œæˆå‘˜</span></span><br><span class="line">  -c                               Disassemble the code <span class="comment"># å¯¹ä»£ç è¿›è¡Œåç¼–è¯‘</span></span><br><span class="line">  -s                               Print internal <span class="built_in">type</span> signatures <span class="comment"># æ‰“å°å†…éƒ¨ç±»å‹ç­¾å</span></span><br><span class="line">  -sysinfo                         Show system info (path, size, <span class="built_in">date</span>, MD5 <span class="built_in">hash</span>) </span><br><span class="line">                                   of class being processed <span class="comment"># æ˜¾ç¤ºç³»ç»Ÿä¿¡æ¯ï¼ˆè·¯å¾„ã€å¤§å°ã€æ—¥æœŸã€MD5 å“ˆå¸Œå€¼ï¼‰</span></span><br><span class="line">  -constants                       Show final constants <span class="comment"># æ˜¾ç¤º final å¸¸é‡</span></span><br><span class="line">  --module &lt;module&gt;, -m &lt;module&gt;   Specify module containing classes to be disassembled</span><br><span class="line">  --module-path &lt;path&gt;             Specify <span class="built_in">where</span> to find application modules</span><br><span class="line">  --system &lt;jdk&gt;                   Specify <span class="built_in">where</span> to find system modules</span><br><span class="line">  --class-path &lt;path&gt;              Specify <span class="built_in">where</span> to find user class files</span><br><span class="line">  -classpath &lt;path&gt;                Specify <span class="built_in">where</span> to find user class files</span><br><span class="line">  -<span class="built_in">cp</span> &lt;path&gt;                       Specify <span class="built_in">where</span> to find user class files</span><br><span class="line">  -bootclasspath &lt;path&gt;            Override location of bootstrap class files</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªå¦‚ä¸‹çš„ç®€å• <code>HelloByteCode</code> ç¨‹åºä½œä¸ºç¤ºä¾‹ï¼Œç¨‹åº <code>main</code> æ–¹æ³•åˆ›å»ºäº†ä¸€ä¸ª <code>HelloByteCode</code> å¯¹è±¡ï¼ˆæºç è¯·å‚è€ƒ <a target="_blank" rel="noopener" href="https://github.com/strongduanmu/jvm-lecture/blob/b6d9fdb4ed79fc3c77de5e70e75c4f1630a04475/src/main/java/com/strongduanmu/jvm/bytecode/HelloByteCode.java#L3">HelloByteCode</a>ï¼‰ï¼Œå¹¶è°ƒç”¨äº† <code>sayHello</code> æ–¹æ³•ï¼Œè¾“å‡º <code>Hello, ByteCode!</code> å­—ç¬¦ä¸²ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">HelloByteCode</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">HelloByteCode</span> <span class="variable">helloByteCode</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HelloByteCode</span>();</span><br><span class="line">        helloByteCode.sayHello();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">sayHello</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Hello, ByteCode!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬ä½¿ç”¨ <code>javac</code> å‘½ä»¤å°†æºç ç¼–è¯‘ä¸ºå­—èŠ‚ç ï¼Œ<code>-g</code> å‚æ•°ç”¨äºç”Ÿæˆæ‰€æœ‰ debug ä¿¡æ¯ï¼Œ<code>javac</code> å‘½ä»¤é»˜è®¤å¼€å¯äº†ä¼˜åŒ–åŠŸèƒ½ï¼Œä¼šå»é™¤å­—èŠ‚ç ä¸­çš„æœ¬åœ°å˜é‡è¡¨ <code>LocalVariableTable</code>ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javac -g HelloByteCode.java</span><br></pre></td></tr></table></figure><p>è·å–åˆ°å­—èŠ‚ç æ–‡ä»¶åï¼Œæˆ‘ä»¬å†é€šè¿‡ <code>javap</code> å‘½ä»¤æŸ¥çœ‹å­—èŠ‚ç ä¿¡æ¯ï¼Œ<code>-c</code> å‚æ•°ç”¨äºå¯¹ä»£ç è¿›è¡Œåç¼–è¯‘ï¼Œ<code>-v</code> å‚æ•°åˆ™ç”¨äºæ‰“å°é™„åŠ ä¿¡æ¯ã€‚å¦‚ä¸‹å±•ç¤ºäº†å®Œæ•´çš„å­—èŠ‚ç ä¿¡æ¯ï¼Œå¤§å®¶å¯ä»¥å…ˆå°è¯•ç†è§£ä¸‹å­—èŠ‚ç çš„å«ä¹‰ï¼Œåœ¨ä¸‹ä¸ªå°èŠ‚æˆ‘ä»¬å°†å¯¹å­—èŠ‚ç è¿›è¡Œæ·±å…¥æ¢ç©¶ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">â¯ javap -c -v HelloByteCode</span><br><span class="line">Warning: File ./HelloByteCode.class does not contain class HelloByteCode</span><br><span class="line">Classfile /Users/duanzhengqiang/IdeaProjects/jvm-lecture/src/main/java/com/strongduanmu/jvm/bytecode/HelloByteCode.class</span><br><span class="line">  Last modified 2024å¹´7æœˆ5æ—¥; size 736 bytes</span><br><span class="line">  MD5 checksum 591e8e496f42a858607d95d6db85bdd8</span><br><span class="line">  Compiled from <span class="string">&quot;HelloByteCode.java&quot;</span></span><br><span class="line">public final class com.strongduanmu.jvm.bytecode.HelloByteCode</span><br><span class="line">  minor version: 0</span><br><span class="line">  major version: 55</span><br><span class="line">  flags: (0x0031) ACC_PUBLIC, ACC_FINAL, ACC_SUPER</span><br><span class="line">  this_class: <span class="comment">#2                          // com/strongduanmu/jvm/bytecode/HelloByteCode</span></span><br><span class="line">  super_class: <span class="comment">#8                         // java/lang/Object</span></span><br><span class="line">  interfaces: 0, fields: 0, methods: 3, attributes: 1</span><br><span class="line">Constant pool:</span><br><span class="line">   <span class="comment">#1 = Methodref          #8.#24         // java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">   <span class="comment">#2 = Class              #25            // com/strongduanmu/jvm/bytecode/HelloByteCode</span></span><br><span class="line">   <span class="comment">#3 = Methodref          #2.#24         // com/strongduanmu/jvm/bytecode/HelloByteCode.&quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">   <span class="comment">#4 = Methodref          #2.#26         // com/strongduanmu/jvm/bytecode/HelloByteCode.sayHello:()V</span></span><br><span class="line">   <span class="comment">#5 = Fieldref           #27.#28        // java/lang/System.out:Ljava/io/PrintStream;</span></span><br><span class="line">   <span class="comment">#6 = String             #29            // Hello, ByteCode!</span></span><br><span class="line">   <span class="comment">#7 = Methodref          #30.#31        // java/io/PrintStream.println:(Ljava/lang/String;)V</span></span><br><span class="line">   <span class="comment">#8 = Class              #32            // java/lang/Object</span></span><br><span class="line">   <span class="comment">#9 = Utf8               &lt;init&gt;</span></span><br><span class="line">  <span class="comment">#10 = Utf8               ()V</span></span><br><span class="line">  <span class="comment">#11 = Utf8               Code</span></span><br><span class="line">  <span class="comment">#12 = Utf8               LineNumberTable</span></span><br><span class="line">  <span class="comment">#13 = Utf8               LocalVariableTable</span></span><br><span class="line">  <span class="comment">#14 = Utf8               this</span></span><br><span class="line">  <span class="comment">#15 = Utf8               Lcom/strongduanmu/jvm/bytecode/HelloByteCode;</span></span><br><span class="line">  <span class="comment">#16 = Utf8               main</span></span><br><span class="line">  <span class="comment">#17 = Utf8               ([Ljava/lang/String;)V</span></span><br><span class="line">  <span class="comment">#18 = Utf8               args</span></span><br><span class="line">  <span class="comment">#19 = Utf8               [Ljava/lang/String;</span></span><br><span class="line">  <span class="comment">#20 = Utf8               helloByteCode</span></span><br><span class="line">  <span class="comment">#21 = Utf8               sayHello</span></span><br><span class="line">  <span class="comment">#22 = Utf8               SourceFile</span></span><br><span class="line">  <span class="comment">#23 = Utf8               HelloByteCode.java</span></span><br><span class="line">  <span class="comment">#24 = NameAndType        #9:#10         // &quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">  <span class="comment">#25 = Utf8               com/strongduanmu/jvm/bytecode/HelloByteCode</span></span><br><span class="line">  <span class="comment">#26 = NameAndType        #21:#10        // sayHello:()V</span></span><br><span class="line">  <span class="comment">#27 = Class              #33            // java/lang/System</span></span><br><span class="line">  <span class="comment">#28 = NameAndType        #34:#35        // out:Ljava/io/PrintStream;</span></span><br><span class="line">  <span class="comment">#29 = Utf8               Hello, ByteCode!</span></span><br><span class="line">  <span class="comment">#30 = Class              #36            // java/io/PrintStream</span></span><br><span class="line">  <span class="comment">#31 = NameAndType        #37:#38        // println:(Ljava/lang/String;)V</span></span><br><span class="line">  <span class="comment">#32 = Utf8               java/lang/Object</span></span><br><span class="line">  <span class="comment">#33 = Utf8               java/lang/System</span></span><br><span class="line">  <span class="comment">#34 = Utf8               out</span></span><br><span class="line">  <span class="comment">#35 = Utf8               Ljava/io/PrintStream;</span></span><br><span class="line">  <span class="comment">#36 = Utf8               java/io/PrintStream</span></span><br><span class="line">  <span class="comment">#37 = Utf8               println</span></span><br><span class="line">  <span class="comment">#38 = Utf8               (Ljava/lang/String;)V</span></span><br><span class="line">&#123;</span><br><span class="line">  public com.strongduanmu.jvm.bytecode.HelloByteCode();</span><br><span class="line">    descriptor: ()V</span><br><span class="line">    flags: (0x0001) ACC_PUBLIC</span><br><span class="line">    Code:</span><br><span class="line">      stack=1, locals=1, args_size=1</span><br><span class="line">         0: aload_0</span><br><span class="line">         1: invokespecial <span class="comment">#1                  // Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">         4: <span class="built_in">return</span></span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line 3: 0</span><br><span class="line">      LocalVariableTable:</span><br><span class="line">        Start  Length  Slot  Name   Signature</span><br><span class="line">            0       5     0  this   Lcom/strongduanmu/jvm/bytecode/HelloByteCode;</span><br><span class="line"></span><br><span class="line">  public static void main(java.lang.String[]);</span><br><span class="line">    descriptor: ([Ljava/lang/String;)V</span><br><span class="line">    flags: (0x0009) ACC_PUBLIC, ACC_STATIC</span><br><span class="line">    Code:</span><br><span class="line">      stack=2, locals=2, args_size=1</span><br><span class="line">         0: new           <span class="comment">#2                  // class com/strongduanmu/jvm/bytecode/HelloByteCode</span></span><br><span class="line">         3: dup</span><br><span class="line">         4: invokespecial <span class="comment">#3                  // Method &quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">         7: astore_1</span><br><span class="line">         8: aload_1</span><br><span class="line">         9: invokevirtual <span class="comment">#4                  // Method sayHello:()V</span></span><br><span class="line">        12: <span class="built_in">return</span></span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line 6: 0</span><br><span class="line">        line 7: 8</span><br><span class="line">        line 8: 12</span><br><span class="line">      LocalVariableTable:</span><br><span class="line">        Start  Length  Slot  Name   Signature</span><br><span class="line">            0      13     0  args   [Ljava/lang/String;</span><br><span class="line">            8       5     1 helloByteCode   Lcom/strongduanmu/jvm/bytecode/HelloByteCode;</span><br><span class="line">&#125;</span><br><span class="line">SourceFile: <span class="string">&quot;HelloByteCode.java&quot;</span></span><br></pre></td></tr></table></figure><h3 id="é€šè¿‡-jclasslib-æŸ¥çœ‹"><a class="markdownIt-Anchor" href="#é€šè¿‡-jclasslib-æŸ¥çœ‹"></a> é€šè¿‡ <code>jclasslib</code> æŸ¥çœ‹</h3><p>é™¤äº†é€šè¿‡ <code>javap</code> å‘½ä»¤æŸ¥çœ‹ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ <a target="_blank" rel="noopener" href="https://github.com/ingokegel/jclasslib">jclasslib</a> å¯è§†åŒ–æŸ¥çœ‹å­—èŠ‚ç ã€‚<code>jclasslib</code> ä¸ä»…æä¾›äº† Idea æ’ä»¶ï¼Œè¿˜æä¾›äº†ç‹¬ç«‹çš„è½¯ä»¶åŒ…ï¼Œå¤§å®¶å¯ä»¥æŒ‰éœ€é€‰æ‹©ä½¿ç”¨ã€‚ç”±äºä½¿ç”¨æ–¹å¼ç±»ä¼¼ï¼Œæœ¬æ–‡ä»¥ Idea æ’ä»¶çš„æ–¹å¼å±•ç¤ºå¦‚ä½•é€šè¿‡ <code>jclasslib</code> æŸ¥çœ‹å­—èŠ‚ç ï¼Œé¦–å…ˆé€‰ä¸­ <code>HelloByteCode</code> æºç æ–‡ä»¶ï¼Œç„¶åé€‰æ‹© <code>View -&gt; Show Bytecode With Jclasslib</code>ã€‚</p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology/show-bytecode-with-jclasslib.png" title="é€šè¿‡ jclasslib æŸ¥çœ‹å­—èŠ‚ç "><p>é€‰æ‹©å®Œæˆåï¼Œå¯ä»¥åœ¨å³ä¾§çš„ Tab ä¸­æŸ¥çœ‹å­—èŠ‚ç ã€‚æ­¤å¤–ï¼Œ<code>jclasslib</code> æ’ä»¶åœ¨æŸ¥çœ‹å­—èŠ‚ç æ—¶ï¼Œå¯ä»¥ç‚¹å‡» <code>Show JVM Spec</code> æŸ¥çœ‹ JVM è™šæ‹Ÿæœºè§„èŒƒï¼ŒæŸ¥çœ‹ç›¸å…³å­—èŠ‚ç æŒ‡ä»¤çš„ä½œç”¨ã€‚</p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology/jclasslib-bytecode-view.png" title="jclasslib å±•ç¤ºçš„å­—èŠ‚ç "><h2 id="æ·±å…¥ç†è§£å­—èŠ‚ç "><a class="markdownIt-Anchor" href="#æ·±å…¥ç†è§£å­—èŠ‚ç "></a> æ·±å…¥ç†è§£å­—èŠ‚ç </h2><h3 id="classfile"><a class="markdownIt-Anchor" href="#classfile"></a> Classfile</h3><p>å‰æ–‡ä»‹ç»äº†ä¸¤ç§æŸ¥çœ‹å­—èŠ‚ç çš„æ–¹æ³•ï¼Œæƒ³å¿…å¤§å®¶å¯¹äºå­—èŠ‚ç ä¸­çš„å†…å®¹è¿˜æœ‰è¯¸å¤šç–‘é—®ã€‚æœ¬èŠ‚æˆ‘å°†å¸¦é¢†å¤§å®¶é€è¡Œåˆ†æï¼Œä¸€èµ·æ·±å…¥æ¢ç©¶å­—èŠ‚ç çš„å†…å®¹ï¼Œå°è¯•ç†è§£å­—èŠ‚ç çš„å«ä¹‰ä¸ä½œç”¨ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹å­—èŠ‚ç ä¸­çš„ <code>Classfile</code>ï¼Œå…·ä½“å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Classfile /Users/duanzhengqiang/IdeaProjects/jvm-lecture/src/main/java/com/strongduanmu/jvm/bytecode/HelloByteCode.class</span><br><span class="line">  Last modified 2024å¹´7æœˆ5æ—¥; size 736 bytes</span><br><span class="line">  MD5 checksum 591e8e496f42a858607d95d6db85bdd8</span><br><span class="line">  Compiled from &quot;HelloByteCode.java&quot;</span><br></pre></td></tr></table></figure><p><code>Classfile</code> å£°æ˜äº†å½“å‰å­—èŠ‚ç æ¥æºçš„ <code>class</code> æ–‡ä»¶è·¯å¾„ï¼Œå¹¶åœ¨ Classfile ä¸‹æ–¹æ˜¾ç¤ºäº† <code>class</code> æ–‡ä»¶çš„æœ€è¿‘ä¿®æ”¹æ—¶é—´ï¼ŒMD5 æ ¡éªŒå€¼ä»¥åŠç¼–è¯‘çš„æ¥æºæ–‡ä»¶ã€‚</p><h3 id="class-åŸºç¡€ä¿¡æ¯"><a class="markdownIt-Anchor" href="#class-åŸºç¡€ä¿¡æ¯"></a> Class åŸºç¡€ä¿¡æ¯</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public final class com.strongduanmu.jvm.bytecode.HelloByteCode</span><br><span class="line">  minor version: 0</span><br><span class="line">  major version: 55</span><br><span class="line">  flags: (0x0031) ACC_PUBLIC, ACC_FINAL, ACC_SUPER</span><br><span class="line">  this_class: #2                          // com/strongduanmu/jvm/bytecode/HelloByteCode</span><br><span class="line">  super_class: #8                         // java/lang/Object</span><br><span class="line">  interfaces: 0, fields: 0, methods: 3, attributes: 1</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒéƒ¨åˆ† <code>public final class com.strongduanmu.jvm.bytecode.HelloByteCode</code> åˆ™å±•ç¤ºäº† Class ç±»çš„ç‰ˆæœ¬å·åŒºé—´ <code>[minor version: 0, major version: 55]</code>ï¼Œ<code>major version: 55</code> å¯¹åº”äº† JDK 11ï¼Œè¡¨ç¤ºå½“å‰ Class ç±»æ”¯æŒ JDK 11 åŠä»¥ä¸‹ç‰ˆæœ¬ã€‚</p><p><code>flags</code> ä»£è¡¨äº†è®¿é—®æ ‡è¯†ç¬¦ï¼Œ<code>0x0031</code> æ˜¯è®¿é—®æ ‡è¯†ç¬¦å€¼çš„ç´¯åŠ ï¼Œ<code>ACC_PUBLIC</code> è¡¨ç¤ºå½“å‰æ˜¯ä¸€ä¸ª public ç±»ï¼Œ<code>ACC_FINAL</code> è¡¨ç¤ºå½“å‰æ˜¯ä¸€ä¸ª final ç±»ï¼Œ<code>ACC_SUPER</code> åˆ™æ˜¯ JDK æ—©æœŸç”¨äºæ ‡è®°å½“å‰ç±»æ˜¾å¼å£°æ˜çš„çˆ¶ç±»ï¼Œä» JDK 1.1 å¼€å§‹ï¼Œæ‰€æœ‰ç±»éƒ½å¿…é¡»æ˜¾å¼å£°æ˜å®ƒä»¬çš„çˆ¶ç±»ï¼ˆå³ä½¿æ˜¯ <code>Object</code>ï¼‰ï¼Œå› æ­¤ <code>ACC_SUPER</code> è®¿é—®æ ‡å¿—å®é™…ä¸Šæ€»æ˜¯è¢«è®¾ç½®ã€‚æ›´å¤šè®¿é—®æ ‡è¯†ç¬¦çš„è¯´æ˜è¯·å‚è€ƒä¸‹è¡¨ï¼š</p><table><thead><tr><th>æ ‡è®°å</th><th>å€¼</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>ACC_PUBLIC</td><td>0x0001</td><td>å¯ä»¥è¢«åŒ…çš„ç±»å¤–è®¿é—®ã€‚</td></tr><tr><td>ACC_FINAL</td><td>0x0010</td><td>ä¸å…è®¸æœ‰å­ç±»ã€‚</td></tr><tr><td>ACC_SUPER</td><td>0x0020</td><td>å½“ç”¨åˆ° invokespecial æŒ‡ä»¤æ—¶ï¼Œéœ€è¦ç‰¹æ®Šå¤„ç†çš„çˆ¶ç±»æ–¹æ³•ã€‚</td></tr><tr><td>ACC_INTERFACE</td><td>0x0200</td><td>æ ‡è¯†å®šä¹‰çš„æ˜¯æ¥å£è€Œä¸æ˜¯ç±»ã€‚</td></tr><tr><td>ACC_ABSTRACT</td><td>0x0400</td><td>ä¸èƒ½è¢«å®ä¾‹åŒ–ã€‚</td></tr><tr><td>ACC_SYNTHETIC</td><td>0x1000</td><td>æ ‡è¯†å¹¶é Java æºç ç”Ÿæˆçš„ä»£ç ã€‚</td></tr><tr><td>ACC_ANNOTATION</td><td>0x2000</td><td>æ ‡è¯†æ³¨è§£ç±»å‹ã€‚</td></tr><tr><td>ACC_ENUM</td><td>0x4000</td><td>æ ‡è¯†æšä¸¾ç±»å‹ã€‚</td></tr></tbody></table><p><code>this_class</code> è¡¨ç¤ºå½“å‰ class ç±»ï¼Œåé¢è·Ÿéšçš„ <code>#2</code> è¡¨ç¤ºå¼•ç”¨å¸¸é‡æ± ä¸­çš„ç¬¬äºŒä¸ªå¸¸é‡ï¼Œå³æ³¨é‡Šä¸­æ˜¾ç¤ºçš„ <code>com/strongduanmu/jvm/bytecode/HelloByteCode</code>ã€‚<code>super_class</code> è¡¨ç¤ºå½“å‰ class ç±»çš„è¶…ç±»ï¼Œ<code>#8</code> è¡¨ç¤ºå¸¸é‡æ± ä¸­çš„ç¬¬å…«ä¸ªå¸¸é‡ï¼Œå³ <code>java/lang/Object</code>ã€‚<code>interfaces: 0, fields: 0, methods: 3, attributes: 1</code> è¡¨ç¤ºå½“å‰ class ç±»ä¸­æ¥å£ã€å­—æ®µã€æ–¹æ³•å’Œå±æ€§çš„æ•°é‡ã€‚</p><h3 id="å¸¸é‡æ± "><a class="markdownIt-Anchor" href="#å¸¸é‡æ± "></a> å¸¸é‡æ± </h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">Constant pool:</span><br><span class="line">   #1 = Methodref          #8.#24         // java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span><br><span class="line">   #2 = Class              #25            // com/strongduanmu/jvm/bytecode/HelloByteCode</span><br><span class="line">   #3 = Methodref          #2.#24         // com/strongduanmu/jvm/bytecode/HelloByteCode.&quot;&lt;init&gt;&quot;:()V</span><br><span class="line">   #4 = Methodref          #2.#26         // com/strongduanmu/jvm/bytecode/HelloByteCode.sayHello:()V</span><br><span class="line">   #5 = Fieldref           #27.#28        // java/lang/System.out:Ljava/io/PrintStream;</span><br><span class="line">   #6 = String             #29            // Hello, ByteCode!</span><br><span class="line">   #7 = Methodref          #30.#31        // java/io/PrintStream.println:(Ljava/lang/String;)V</span><br><span class="line">   #8 = Class              #32            // java/lang/Object</span><br><span class="line">   #9 = Utf8               &lt;init&gt;</span><br><span class="line">  #10 = Utf8               ()V</span><br><span class="line">  #11 = Utf8               Code</span><br><span class="line">  #12 = Utf8               LineNumberTable</span><br><span class="line">  #13 = Utf8               LocalVariableTable</span><br><span class="line">  #14 = Utf8               this</span><br><span class="line">  #15 = Utf8               Lcom/strongduanmu/jvm/bytecode/HelloByteCode;</span><br><span class="line">  #16 = Utf8               main</span><br><span class="line">  #17 = Utf8               ([Ljava/lang/String;)V</span><br><span class="line">  #18 = Utf8               args</span><br><span class="line">  #19 = Utf8               [Ljava/lang/String;</span><br><span class="line">  #20 = Utf8               helloByteCode</span><br><span class="line">  #21 = Utf8               sayHello</span><br><span class="line">  #22 = Utf8               SourceFile</span><br><span class="line">  #23 = Utf8               HelloByteCode.java</span><br><span class="line">  #24 = NameAndType        #9:#10         // &quot;&lt;init&gt;&quot;:()V</span><br><span class="line">  #25 = Utf8               com/strongduanmu/jvm/bytecode/HelloByteCode</span><br><span class="line">  #26 = NameAndType        #21:#10        // sayHello:()V</span><br><span class="line">  #27 = Class              #33            // java/lang/System</span><br><span class="line">  #28 = NameAndType        #34:#35        // out:Ljava/io/PrintStream;</span><br><span class="line">  #29 = Utf8               Hello, ByteCode!</span><br><span class="line">  #30 = Class              #36            // java/io/PrintStream</span><br><span class="line">  #31 = NameAndType        #37:#38        // println:(Ljava/lang/String;)V</span><br><span class="line">  #32 = Utf8               java/lang/Object</span><br><span class="line">  #33 = Utf8               java/lang/System</span><br><span class="line">  #34 = Utf8               out</span><br><span class="line">  #35 = Utf8               Ljava/io/PrintStream;</span><br><span class="line">  #36 = Utf8               java/io/PrintStream</span><br><span class="line">  #37 = Utf8               println</span><br><span class="line">  #38 = Utf8               (Ljava/lang/String;)V</span><br></pre></td></tr></table></figure><p><code>Constant pool</code> è¡¨ç¤ºå¸¸é‡æ± ï¼Œå…¶ä¸­å£°æ˜äº†å­—èŠ‚ç ä¸­éœ€è¦ä½¿ç”¨çš„å¸¸é‡ï¼Œ<code>#1</code>ã€<code>#2</code> ç­‰è¡¨ç¤ºå¸¸é‡çš„ç¼–å·ï¼Œå­—èŠ‚ç ä¸­ä½¿ç”¨å¸¸é‡æ—¶ï¼Œåªéœ€è¦å¼•ç”¨ç›¸å…³çš„ç¼–å·å³å¯ã€‚<code>Methodref</code>ã€<code>Class</code>ã€<code>Fieldref</code> æ˜¯å¸¸é‡çš„ç±»å‹ï¼Œåˆ†åˆ«è¡¨ç¤ºæ–¹æ³•å¼•ç”¨ï¼ŒClass ç±»ä»¥åŠå­—æ®µå¼•ç”¨ï¼Œæ›´å¤šå¸¸é‡ç±»å‹å¯å‚è€ƒå¦‚ä¸‹å¸¸é‡ç±»å‹è¡¨æ ¼ã€‚å¸¸é‡ä¸­å¯ä»¥é€šè¿‡ç¼–å·å¼•ç”¨å…¶ä»–å¸¸é‡ï¼Œä¾‹å¦‚ï¼š<code>#8.#24</code>ï¼Œä»£è¡¨äº†å¯¹ <code>Object</code> å¯¹è±¡ <code>init</code> æ–¹æ³•çš„å¼•ç”¨ï¼Œå­—èŠ‚ç æ³¨é‡Š <code>java/lang/Object.&quot;&lt;init&gt;&quot;:()V</code> å·²ç»å¾ˆå¥½åœ°å‘æˆ‘ä»¬å±•ç¤ºäº†æ–¹æ³•å¼•ç”¨ã€‚</p><table><thead><tr><th>å¸¸é‡ç±»å‹</th><th>å€¼</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>CONSTANT_Class</td><td>7</td><td>ç±»æˆ–æ¥å£</td></tr><tr><td>CONSTANT_Fieldref</td><td>9</td><td>å­—æ®µå¼•ç”¨</td></tr><tr><td>CONSTANT_Methodref</td><td>10</td><td>ç±»æ–¹æ³•å¼•ç”¨</td></tr><tr><td>CONSTANT_InterfaceMethodref</td><td>11</td><td>æ¥å£æ–¹æ³•å¼•ç”¨</td></tr><tr><td>CONSTANT_String</td><td>8</td><td><code>java.lang.String</code> ç±»å‹çš„å¸¸é‡</td></tr><tr><td>CONSTANT_Integer</td><td>3</td><td>4 å­—èŠ‚æ•´å‹å¸¸é‡</td></tr><tr><td>CONSTANT_Float</td><td>4</td><td>4 å­—èŠ‚æµ®ç‚¹å‹å¸¸é‡</td></tr><tr><td>CONSTANT_Long</td><td>5</td><td>8 å­—èŠ‚é•¿æ•´å‹å¸¸é‡</td></tr><tr><td>CONSTANT_Double</td><td>6</td><td>8 å­—èŠ‚åŒç²¾åº¦æµ®ç‚¹å‹å¸¸é‡</td></tr><tr><td>CONSTANT_NameAndType</td><td>12</td><td>å­—æ®µæˆ–æ–¹æ³•çš„åç§°å’Œç±»å‹ï¼Œç±»å‹é€šè¿‡å­—æ®µæè¿°ç¬¦ï¼ˆä¾‹å¦‚ï¼š<code>[Ljava/lang/String;</code>ï¼‰æˆ–æ–¹æ³•æè¿°ç¬¦ï¼ˆä¾‹å¦‚ï¼š<code>(Ljava/lang/String;)V</code>ï¼‰è¿›è¡Œè¡¨ç¤º</td></tr><tr><td>CONSTANT_Utf8</td><td>1</td><td><code>UTF-8</code> ç¼–ç è¡¨ç¤ºçš„å­—ç¬¦ä¸²å¸¸é‡å€¼</td></tr><tr><td>CONSTANT_MethodHandle</td><td>15</td><td>æ–¹æ³•å¥æŸ„</td></tr><tr><td>CONSTANT_MethodType</td><td>16</td><td>æ–¹æ³•ç±»å‹</td></tr><tr><td>CONSTANT_InvokeDynamic</td><td>18</td><td><code>invohecynamic</code> åŠ¨æ€æ–¹æ³•è°ƒç”¨</td></tr></tbody></table><h3 id="å­—èŠ‚ç "><a class="markdownIt-Anchor" href="#å­—èŠ‚ç "></a> å­—èŠ‚ç </h3><p>ä»‹ç»å®Œå¸¸é‡æ± åï¼Œæˆ‘ä»¬å†æ¥å…³æ³¨ä¸‹æœ€æ ¸å¿ƒçš„å­—èŠ‚ç æŒ‡ä»¤ï¼Œç”±äºæœ¬æ–‡ç¤ºä¾‹ç¨‹åºä¸­åŒ…å«äº†ç§æœ‰æ–¹æ³•ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨ <code>javap -c -v -p HelloByteCode</code> æŸ¥çœ‹åŒ…å«ç§æœ‰æ–¹æ³•åœ¨å†…çš„æ‰€æœ‰æˆå‘˜å˜é‡å’Œæ–¹æ³•ã€‚å¦‚ä¸‹å±•ç¤ºäº†å­—èŠ‚ç ä¿¡æ¯ï¼Œå¯ä»¥çœ‹åˆ°æ€»å…±åŒ…å«äº† 3 ä¸ªæ–¹æ³•â€”â€”<code>HelloByteCode</code> æ„é€ æ–¹æ³•ã€<code>main</code> æ–¹æ³•ã€<code>sayHello</code> æ–¹æ³•ï¼Œä¸‹é¢æˆ‘ä»¬å°†åˆ†åˆ«è¿›è¡Œæ¢ç©¶å­¦ä¹ ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="keyword">public</span> com.strongduanmu.jvm.bytecode.HelloByteCode();</span><br><span class="line">    descriptor: ()V</span><br><span class="line">    flags: (<span class="number">0x0001</span>) ACC_PUBLIC</span><br><span class="line">    Code:</span><br><span class="line">      stack=<span class="number">1</span>, locals=<span class="number">1</span>, args_size=<span class="number">1</span></span><br><span class="line">         <span class="number">0</span>: aload_0</span><br><span class="line">         <span class="number">1</span>: invokespecial #<span class="number">1</span>                  <span class="comment">// Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">         <span class="number">4</span>: <span class="keyword">return</span></span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line <span class="number">3</span>: <span class="number">0</span></span><br><span class="line">      LocalVariableTable:</span><br><span class="line">        Start  Length  Slot  Name   Signature</span><br><span class="line">            <span class="number">0</span>       <span class="number">5</span>     <span class="number">0</span>  <span class="built_in">this</span>   Lcom/strongduanmu/jvm/bytecode/HelloByteCode;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(java.lang.String[])</span>;</span><br><span class="line">    descriptor: ([Ljava/lang/String;)V</span><br><span class="line">    flags: (<span class="number">0x0009</span>) ACC_PUBLIC, ACC_STATIC</span><br><span class="line">    Code:</span><br><span class="line">      stack=<span class="number">2</span>, locals=<span class="number">2</span>, args_size=<span class="number">1</span></span><br><span class="line">         <span class="number">0</span>: <span class="keyword">new</span>           #<span class="number">7</span>                  <span class="comment">// class com/strongduanmu/jvm/bytecode/HelloByteCode</span></span><br><span class="line">         <span class="number">3</span>: dup</span><br><span class="line">         <span class="number">4</span>: invokespecial #<span class="number">9</span>                  <span class="comment">// Method &quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">         <span class="number">7</span>: astore_1</span><br><span class="line">         <span class="number">8</span>: aload_1</span><br><span class="line">         <span class="number">9</span>: invokevirtual #<span class="number">10</span>                 <span class="comment">// Method sayHello:()V</span></span><br><span class="line">        <span class="number">12</span>: <span class="keyword">return</span></span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line <span class="number">6</span>: <span class="number">0</span></span><br><span class="line">        line <span class="number">7</span>: <span class="number">8</span></span><br><span class="line">        line <span class="number">8</span>: <span class="number">12</span></span><br><span class="line">      LocalVariableTable:</span><br><span class="line">        Start  Length  Slot  Name   Signature</span><br><span class="line">            <span class="number">0</span>      <span class="number">13</span>     <span class="number">0</span>  args   [Ljava/lang/String;</span><br><span class="line">            <span class="number">8</span>       <span class="number">5</span>     <span class="number">1</span> helloByteCode   Lcom/strongduanmu/jvm/bytecode/HelloByteCode;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">sayHello</span><span class="params">()</span>;</span><br><span class="line">    descriptor: ()V</span><br><span class="line">    flags: (<span class="number">0x0002</span>) ACC_PRIVATE</span><br><span class="line">    Code:</span><br><span class="line">      stack=<span class="number">2</span>, locals=<span class="number">1</span>, args_size=<span class="number">1</span></span><br><span class="line">         <span class="number">0</span>: getstatic     #<span class="number">13</span>                 <span class="comment">// Field java/lang/System.out:Ljava/io/PrintStream;</span></span><br><span class="line">         <span class="number">3</span>: ldc           #<span class="number">19</span>                 <span class="comment">// String Hello, ByteCode!</span></span><br><span class="line">         <span class="number">5</span>: invokevirtual #<span class="number">21</span>                 <span class="comment">// Method java/io/PrintStream.println:(Ljava/lang/String;)V</span></span><br><span class="line">         <span class="number">8</span>: <span class="keyword">return</span></span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line <span class="number">11</span>: <span class="number">0</span></span><br><span class="line">        line <span class="number">12</span>: <span class="number">8</span></span><br><span class="line">      LocalVariableTable:</span><br><span class="line">        Start  Length  Slot  Name   Signature</span><br><span class="line">            <span class="number">0</span>       <span class="number">9</span>     <span class="number">0</span>  <span class="built_in">this</span>   Lcom/strongduanmu/jvm/bytecode/HelloByteCode;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="hellobytecode-æ„é€ æ–¹æ³•"><a class="markdownIt-Anchor" href="#hellobytecode-æ„é€ æ–¹æ³•"></a> HelloByteCode æ„é€ æ–¹æ³•</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> com.strongduanmu.jvm.bytecode.HelloByteCode();</span><br><span class="line">  descriptor: ()V</span><br><span class="line">  flags: (<span class="number">0x0001</span>) ACC_PUBLIC</span><br><span class="line">  Code:</span><br><span class="line">    stack=<span class="number">1</span>, locals=<span class="number">1</span>, args_size=<span class="number">1</span></span><br><span class="line">       <span class="number">0</span>: aload_0</span><br><span class="line">       <span class="number">1</span>: invokespecial #<span class="number">1</span>                  <span class="comment">// Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">       <span class="number">4</span>: <span class="keyword">return</span></span><br><span class="line">    LineNumberTable:</span><br><span class="line">      line <span class="number">3</span>: <span class="number">0</span></span><br><span class="line">    LocalVariableTable:</span><br><span class="line">      Start  Length  Slot  Name   Signature</span><br><span class="line">          <span class="number">0</span>       <span class="number">5</span>     <span class="number">0</span>  <span class="built_in">this</span>   Lcom/strongduanmu/jvm/bytecode/HelloByteCode;</span><br></pre></td></tr></table></figure><p>HelloByteCode æ„é€ æ–¹æ³•æ˜¯ Java ç¼–è¯‘å™¨é»˜è®¤ç”Ÿæˆçš„ï¼Œäº†è§£ Java çš„æœ‹å‹éƒ½çŸ¥é“ï¼Œå½“æˆ‘ä»¬åœ¨ç¨‹åºä¸­æ²¡æœ‰å®šä¹‰ä»»ä½•æ„é€ æ–¹æ³•æ—¶ï¼ŒJava ç¼–è¯‘å™¨ä¼šé»˜è®¤ç”Ÿæˆæ— å‚çš„æ„é€ æ–¹æ³•ã€‚<code>public com.strongduanmu.jvm.bytecode.HelloByteCode();</code> æ˜¯æ„é€ æ–¹æ³•çš„æ–¹æ³•å£°æ˜ï¼ŒHelloByteCode å‰é¢ä¼šå¸¦ä¸Šå®Œæ•´çš„åŒ…è·¯å¾„ã€‚</p><p><code>descriptor</code> åˆ™æ˜¯æ–¹æ³•æè¿°ç¬¦ï¼Œ<code>()V</code> ä¸­ <code>()</code> è¡¨ç¤ºå…¥å‚ï¼Œé»˜è®¤æ„é€ æ–¹æ³•çš„å…¥å‚ä¸ºç©ºï¼Œ<code>()</code> ä¹‹åæ˜¯è¿”å›å€¼ï¼Œç”±äºæ„é€ æ–¹æ³•æ²¡æœ‰ä»»ä½•è¿”å›å€¼ï¼Œå› æ­¤è¿”å›å€¼ä¸º <code>void</code>ï¼Œç¼©å†™ä¸º <code>V</code>ã€‚</p><p><code>flags</code> è¡¨ç¤ºè®¿é—®æ ‡è¯†ç¬¦ï¼Œ<code>ACC_PUBLIC</code> è¡¨ç¤ºè¯¥æ„é€ æ–¹æ³•ä¸º <code>public</code> æ„é€ æ–¹æ³•ï¼Œæ›´å¤šè®¿é—®æ ‡è¯†ç¬¦ç±»å‹å¯å‚è€ƒ <a href="#class-%E5%9F%BA%E7%A1%80%E4%BF%A1%E6%81%AF">Class åŸºç¡€ä¿¡æ¯</a>ã€‚</p><p><code>Code</code> åˆ™å¯¹åº”äº†å…·ä½“çš„ä»£ç é€»è¾‘ï¼Œ<code>stack=1, locals=1, args_size=1</code> ä¸­çš„ <code>stack</code> è¡¨ç¤ºå½“å‰æ–¹æ³•æ‰§è¡Œæ—¶æœ€å¤§çš„æ ˆä½¿ç”¨æ·±åº¦ï¼Œ<code>HelloByteCode</code> æ„é€ æ–¹æ³•æ ˆæ·±åº¦ä¸º 1ï¼Œ<code>locals</code> è¡¨ç¤ºæœ¬åœ°å˜é‡è¡¨ä¸­æ§½ä½çš„ä¸ªæ•°ï¼Œ<code>args_size</code> è¡¨ç¤ºæ–¹æ³•çš„å‚æ•°ä¸ªæ•°ã€‚</p><blockquote><p>å¥½å¥‡çš„åŒå­¦å¯èƒ½ä¼šé—®ï¼šé»˜è®¤æ— å‚æ„é€ æ–¹æ³•çš„å‚æ•°ä¸ªæ•°ä¸ºä»€ä¹ˆæ˜¯ 1ï¼Ÿå› ä¸ºåœ¨ Java ä¸­ï¼Œéé™æ€æ–¹æ³•ï¼ˆåŒ…æ‹¬æ„é€ æ–¹æ³•ï¼‰ä¼šæœ‰ä¸€ä¸ª <code>this</code> å¼•ç”¨ï¼Œå¹¶ä¸” <code>this</code> ä¼šä½œä¸ºæ–¹æ³•çš„éšè—å‚æ•°ï¼Œ<code>this</code> ä¼šå­˜å‚¨åœ¨æœ¬åœ°å˜é‡è¡¨çš„ç¬¬ 1 ä¸ªæ§½ä½ï¼Œæ‰€ä»¥å­—èŠ‚ç é‡Œ <code>args_size</code> ä¸º 1ã€‚</p></blockquote><p><code>0: aload_0</code> ä¸­çš„ <code>0</code> è¡¨ç¤ºå½“å‰æŒ‡ä»¤ä½äºè¯¥æ–¹æ³•æŒ‡ä»¤çš„ 0 ä½ç½®ï¼Œ<code>aload_0</code> è¡¨ç¤ºå°†ç¬¬ä¸€ä¸ªå¼•ç”¨ç±»å‹æœ¬åœ°å˜é‡å‹å…¥æ ˆé¡¶ã€‚ä¸‹å›¾å±•ç¤ºäº† <code>Local Variable</code> å’Œ <code>Stack</code> å…³ç³»ï¼Œç”±äº JVM æ˜¯ä¸€ä¸ªåŸºäºæ ˆçš„è®¡ç®—æœºå™¨ï¼Œå› æ­¤åœ¨è®¡ç®—çš„è¿‡ç¨‹ä¸­ä¼šæ‰§è¡Œå¾ˆå¤šå‹å…¥å’Œå¼¹å‡ºæ“ä½œï¼Œå³ Load å’Œ Store æŒ‡ä»¤ã€‚</p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology/local-variable-and-stack-relationship.png" title="Local Variable å’Œ Stack å…³ç³»"><p><code>1: invokespecial #1</code> ä¸­çš„ <code>1</code> è¡¨ç¤ºå½“å‰æŒ‡ä»¤ä½äºè¯¥æ–¹æ³•æŒ‡ä»¤çš„ 1 ä½ç½®ï¼Œ<code>invokespecial</code> è¡¨ç¤ºè°ƒç”¨è¶…ç±»æ„é€ æ–¹æ³•ã€å®ä¾‹åˆå§‹åŒ–æ–¹æ³•æˆ–ç§æœ‰æ–¹æ³•ï¼Œ<code>#1</code> å¼•ç”¨äº†å¸¸é‡æ± ä¸­çš„ç¬¬ä¸€ä¸ªå¸¸é‡ï¼Œå³ <code>#1 = Methodref #8.#24 // java/lang/Object.&quot;&lt;init&gt;&quot;:()V</code>ã€‚ä»æ•´ä¸ªæŒ‡ä»¤æ¥çœ‹ï¼Œè°ƒç”¨çš„æ˜¯è¶…ç±»æ„é€ æ–¹æ³•ï¼š<code>Object</code> ç±»çš„ <code>init</code> æ–¹æ³•ã€‚</p><p><code>4: return</code> ä¸­çš„ <code>4</code> è¡¨ç¤ºå½“å‰æŒ‡ä»¤ä½äºè¯¥æ–¹æ³•æŒ‡ä»¤çš„ 4 ä½ç½®ï¼Œ<code>return</code> è¡¨ç¤ºä»å½“å‰æ–¹æ³•è¿”å› voidã€‚</p><p><code>LineNumberTable</code> è¡Œå·è¡¨è®°å½•äº†æºç ä¸­è¡Œå·å’Œæ–¹æ³•æŒ‡ä»¤çš„ä½ç½®ï¼Œ<code>line 3: 0</code> ä¸­çš„ <code>3</code> è¡¨ç¤ºæºç ä¸­çš„ç¬¬ 3 è¡Œï¼Œ<code>0</code> è¡¨ç¤ºæ–¹æ³•æŒ‡ä»¤çš„ç¬¬ 0 ä¸ªä½ç½®ï¼Œå³ <code>0: aload_0</code>ã€‚</p><p><code>LocalVariableTable</code> æœ¬åœ°å˜é‡è¡¨è®°å½•äº†å½“å‰æ–¹æ³•ä¸­çš„æœ¬åœ°å˜é‡ï¼Œ<code>Start</code> è¡¨ç¤ºèµ·å§‹ä½ç½®ï¼Œæ ‡è¯†äº†è¯¥å˜é‡åœ¨å­—èŠ‚ç ä¸­çš„å“ªè¡Œå¼€å§‹èµ·ä½œç”¨ï¼Œ<code>Length</code> è¡¨ç¤ºæŒ‡ä»¤ä½œç”¨èŒƒå›´ï¼Œå¯¹åº”çš„æ˜¯å­—èŠ‚ç ä¸­çš„ä½ç½®ã€‚å¯ä»¥çœ‹åˆ°ï¼Œé»˜è®¤æ„é€ æ–¹æ³•æœ‰ä¸€ä¸ª <code>this</code> å˜é‡ï¼Œ<code>Slot</code> è¡¨ç¤ºæ§½ä½ï¼Œ<code>Signature</code> è¡¨ç¤ºå˜é‡çš„ç­¾åä¿¡æ¯ï¼Œå…¶ä¸­ <code>L&lt;ClassName&gt;</code> æ˜¯å¼•ç”¨ç±»å‹çš„å­—æ®µæè¿°ç¬¦ã€‚ä¸‹è¡¨å±•ç¤ºäº†å¸¸ç”¨ç±»å‹çš„å­—æ®µæè¿°ç¬¦ï¼Œåœ¨å­—èŠ‚ç ä¸­æˆ‘ä»¬ä¼šç»å¸¸çœ‹åˆ°è¿™äº›å­—æ®µæè¿°ç¬¦ä¿¡æ¯ï¼Œå¤§å®¶å¯ä»¥éšæ—¶æŸ¥é˜…è¡¨æ ¼åŠ å¼ºç†è§£ã€‚</p><table><thead><tr><th>å­—ç¬¦</th><th>ç±»å‹</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>B</td><td>byte</td><td>æœ‰ç¬¦å·å­—èŠ‚å‹æ•°</td></tr><tr><td>C</td><td>char</td><td>Unicode å­—ç¬¦ï¼ŒUTF-16 ç¼–ç </td></tr><tr><td>D</td><td>double</td><td>åŒç²¾åº¦æµ®ç‚¹æ•°</td></tr><tr><td>F</td><td>float</td><td>å•ç²¾åº¦æµ®ç‚¹æ•°</td></tr><tr><td>I</td><td>int</td><td>æ•´å‹æ•°</td></tr><tr><td>J</td><td>long</td><td>é•¿æ•´æ•°</td></tr><tr><td>S</td><td>short</td><td>æœ‰ç¬¦å·çŸ­æ•´æ•°</td></tr><tr><td>Z</td><td>boolean</td><td>å¸ƒå°”å€¼ true/false</td></tr><tr><td>L Classname;</td><td>reference</td><td>ä¸€ä¸ªåä¸º Classname çš„å®ä¾‹</td></tr><tr><td>[</td><td>reference</td><td>ä¸€ä¸ªä¸€ç»´æ•°ç»„</td></tr></tbody></table><p>å­—æ®µæè¿°ç¬¦ç¤ºä¾‹ï¼š</p><ul><li><code>int</code> å®ä¾‹å˜é‡çš„æè¿°ç¬¦æ˜¯ <code>I</code>ï¼›</li><li><code>java.lang.Object</code> æè¿°ç¬¦æ˜¯ <code>Ljava/lang/Object;</code>ï¼›</li><li><code>double</code> çš„ä¸‰ç»´æ•°ç»„ <code>double d[][][]</code> æè¿°ç¬¦æ˜¯ <code>[[[D</code>ã€‚</li></ul><h4 id="main-æ–¹æ³•"><a class="markdownIt-Anchor" href="#main-æ–¹æ³•"></a> main æ–¹æ³•</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(java.lang.String[])</span>;</span><br><span class="line">  descriptor: ([Ljava/lang/String;)V</span><br><span class="line">  flags: (<span class="number">0x0009</span>) ACC_PUBLIC, ACC_STATIC</span><br><span class="line">  Code:</span><br><span class="line">    stack=<span class="number">2</span>, locals=<span class="number">2</span>, args_size=<span class="number">1</span></span><br><span class="line">       <span class="number">0</span>: <span class="keyword">new</span>           #<span class="number">7</span>                  <span class="comment">// class com/strongduanmu/jvm/bytecode/HelloByteCode</span></span><br><span class="line">       <span class="number">3</span>: dup</span><br><span class="line">       <span class="number">4</span>: invokespecial #<span class="number">9</span>                  <span class="comment">// Method &quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">       <span class="number">7</span>: astore_1</span><br><span class="line">       <span class="number">8</span>: aload_1</span><br><span class="line">       <span class="number">9</span>: invokevirtual #<span class="number">10</span>                 <span class="comment">// Method sayHello:()V</span></span><br><span class="line">      <span class="number">12</span>: <span class="keyword">return</span></span><br><span class="line">    LineNumberTable:</span><br><span class="line">      line <span class="number">6</span>: <span class="number">0</span></span><br><span class="line">      line <span class="number">7</span>: <span class="number">8</span></span><br><span class="line">      line <span class="number">8</span>: <span class="number">12</span></span><br><span class="line">    LocalVariableTable:</span><br><span class="line">      Start  Length  Slot  Name   Signature</span><br><span class="line">          <span class="number">0</span>      <span class="number">13</span>     <span class="number">0</span>  args   [Ljava/lang/String;</span><br><span class="line">          <span class="number">8</span>       <span class="number">5</span>     <span class="number">1</span> helloByteCode   Lcom/strongduanmu/jvm/bytecode/HelloByteCode;</span><br></pre></td></tr></table></figure><p>æœ‰äº† HelloByteCode æ„é€ æ–¹æ³•çš„åŸºç¡€ï¼Œæˆ‘ä»¬é˜…è¯» <code>main</code> æ–¹æ³•çš„å­—èŠ‚ç ä¼šå¾ˆè½»æ¾ï¼Œ<code>descriptor</code> è¡¨ç¤ºäº†æ–¹æ³•æè¿°ç¬¦ï¼Œ<code>([Ljava/lang/String;)V</code> è¡¨ç¤ºå…¥å‚ä¸º <code>String</code> æ•°ç»„ï¼Œè¿”å›å€¼ä¸º <code>void</code>ï¼Œè¿™å’Œæˆ‘ä»¬è®°å¿†ä¸­çš„ <code>main</code> æ–¹æ³•å£°æ˜æ˜¯å®Œå…¨ä¸€è‡´çš„ã€‚<code>flags</code> å£°æ˜äº† <code>main</code> æ–¹æ³•ä¸º <code>public</code> å…¬æœ‰æ–¹æ³•ï¼Œå¹¶ä¸”æ˜¯ <code>static</code> é™æ€æ–¹æ³•ã€‚</p><p><code>Code</code> éƒ¨åˆ† <code>stack=2, locals=2, args_size=1</code> ä¸­çš„ <code>stack=2</code>è¡¨ç¤ºå½“å‰æ–¹æ³•æ‰§è¡Œæ—¶ä½¿ç”¨çš„æœ€å¤§æ ˆæ·±åº¦ä¸º 2ï¼Œæˆ‘ä»¬å°†åœ¨åæ–‡<strong>å­—èŠ‚ç æ‰§è¡Œè¿‡ç¨‹</strong>å°èŠ‚ä¸­ï¼Œä¸ºå¤§å®¶è¯¦ç»†ä»‹ç»æ ˆåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­çš„ä½œç”¨ã€‚<code>locals=2</code> è¡¨ç¤ºè¯¥æ–¹æ³•çš„æœ¬åœ°å˜é‡æ•°ä¸º 2ï¼Œå³ï¼š<code>args</code> å’Œ <code>helloByteCode</code>ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆ <code>main</code> æ–¹æ³•çš„æœ¬åœ°å˜é‡æ²¡æœ‰ <code>this</code>ï¼Ÿæˆ‘ä»¬å‰æ–‡ä»‹ç»è¿‡ï¼Œåªæœ‰éé™æ€æ–¹æ³•ä¼šæœ‰å½“å‰å¯¹è±¡çš„ <code>this</code> å¼•ç”¨ï¼Œè€Œ <code>main</code> æ–¹æ³•æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ã€‚<code>args_size=1</code> è¡¨ç¤ºäº† <code>main</code> æ–¹æ³•æœ‰ä¸€ä¸ªå‚æ•° <code>args</code>ã€‚</p><p>å­—èŠ‚ç éƒ¨åˆ†ï¼Œä¸ºäº†æ–¹ä¾¿å¤§å®¶ç†è§£ï¼Œå¯ä»¥å‚è€ƒä¸‹é¢çš„å­—èŠ‚ç æŒ‡ä»¤å›¾ã€‚<code>0: new #7</code> è¡¨ç¤ºæ–¹æ³•å­—èŠ‚ç çš„ç¬¬ 0 ä¸ªä½ç½®ï¼Œ<code>new</code> æ˜¯ä¸€ä¸ªæ“ä½œç ï¼Œè¡¨ç¤ºåˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶å°†å…¶å¼•ç”¨å€¼å‹å…¥æ ˆé¡¶ï¼Œåé¢ç´§è·Ÿç€çš„ <code>#7</code> æ˜¯æ“ä½œæ•°ï¼Œå¼•ç”¨çš„æ˜¯å¸¸é‡æ± ä¸­çš„ç¬¬ 7 ä¸ªå¸¸é‡ï¼Œç”±äº JVM æ“ä½œæ•°æ ˆæ˜¯åŸºäºæ§½ï¼ˆ<code>Slot</code>ï¼‰ï¼Œæ¯ä¸ªæ§½é»˜è®¤ä¸º 32 ä½å®½ï¼Œå³ 4 ä½ 16 è¿›åˆ¶æ•°ï¼Œå› æ­¤ 07 ä¹‹å‰éœ€è¦ç”¨ 00 è¡¥ä½ã€‚å‚è€ƒ <a href="https://strongduanmu.com/blog/opcode-mnemonics-by-opcode.html">Java è™šæ‹ŸæœºæŒ‡ä»¤æ“ä½œç å’ŒåŠ©è®°ç¬¦æ˜ å°„å…³ç³»</a>ï¼Œæˆ‘ä»¬å¯ä»¥å¿«é€ŸæŸ¥é˜…åˆ° <code>new</code> æ“ä½œç å¯¹åº”çš„ 16 è¿›åˆ¶ä¸º bbï¼Œå› æ­¤ <code>0: new #7</code> ä½¿ç”¨ 16 è¿›åˆ¶çš„è¡¨ç°å½¢å¼ä¸º <code>bb0007</code>ã€‚</p><p><code>3: dup</code> è¡¨ç¤ºå­—èŠ‚ç çš„ç¬¬ 3 ä¸ªä½ç½®ï¼Œ<code>dup</code>ï¼ˆå…¨ç§° <code>duplicate</code>ï¼‰ è¡¨ç¤ºå¤åˆ¶æ ˆé¡¶æ•°å€¼ï¼Œå¹¶å°†å¤åˆ¶å€¼å‹å…¥æ ˆé¡¶ï¼Œåé¢æ²¡æœ‰æ“ä½œæ•°ï¼Œå› æ­¤å®ƒçš„ 16 è¿›åˆ¶è¡¨ç¤ºä¸º <code>59</code>ã€‚</p><p><code>4: invokespecial #9</code> å‰æ–‡å·²ç»ä»‹ç»ï¼Œè¯¥æ“ä½œç è¡¨ç¤ºè°ƒç”¨è¶…ç±»æ„é€ æ–¹æ³•ï¼Œå®ä¾‹åˆå§‹åŒ–æ–¹æ³•æˆ–ç§æœ‰æ–¹æ³•ï¼Œæ­¤å¤„è¡¨ç¤ºå¯¹ HelloByteCode åˆå§‹åŒ–æ—¶ <code>init</code> æ–¹æ³•çš„è°ƒç”¨ï¼Œ<code>invokespecial</code> æ“ä½œç å¯¹åº”çš„ 16 è¿›åˆ¶ä¸º b7ï¼ŒåŒæ ·æ“ä½œæ•°éœ€è¦ç”¨ 00 è¡¥ä½ï¼Œæœ€ç»ˆ <code>4: invokespecial #9</code> 16 è¿›åˆ¶è¡¨ç¤ºä¸º <code>b70009</code>ã€‚</p><p><code>astore_1</code> è¡¨ç¤ºå°†æ ˆé¡¶å¼•ç”¨å‹æ•°å€¼å­˜å…¥ç¬¬äºŒä¸ªæœ¬åœ°å˜é‡ï¼Œ<code>aload_1</code> è¡¨ç¤ºå°†ç¬¬äºŒä¸ªå¼•ç”¨ç±»å‹æœ¬åœ°å˜é‡æ¨è‡³æ ˆé¡¶ï¼Œè¿™ä¸¤ä¸ªæ“ä½œç åé¢éƒ½æ²¡æœ‰æ“ä½œæ•°ï¼Œå®ƒä»¬ 16 è¿›åˆ¶çš„è¡¨ç¤ºåˆ†åˆ«ä¸º <code>4c</code> å’Œ <code>2b</code>ã€‚</p><p><code>9: invokevirtual #10</code> è¡¨ç¤ºè°ƒç”¨å®ä¾‹æ–¹æ³•ï¼Œæ­¤å¤„ä¸ºè°ƒç”¨ <code>sayHello</code> å®ä¾‹æ–¹æ³•ï¼Œ<code>invokevirtual</code> æ“ä½œç å¯¹åº”çš„ 16 è¿›åˆ¶ä¸º b6ï¼Œç»è¿‡è¡¥ä½åçš„ 16 è¿›åˆ¶è¡¨ç¤ºä¸º <code>b6000a</code>ã€‚æœ€å <code>return</code> æ“ä½œç è¡¨ç¤ºäº†æ–¹æ³•è¿”å› voidï¼Œå¯¹åº”çš„ 16 è¿›åˆ¶è¡¨ç¤ºä¸º <code>b1</code>ã€‚</p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology/class-bytecode.png" title="å­—èŠ‚ç æŒ‡ä»¤"><p>é‚£ä¹ˆï¼Œæ ¹æ®å­—èŠ‚ç åŠ©è®°ç¬¦è½¬æ¢å‡ºæ¥çš„ 16 è¿›åˆ¶å­˜å‚¨åœ¨å“ªé‡Œå‘¢ï¼Ÿç­”æ¡ˆæ˜¯ class æ–‡ä»¶ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>Sublime Text</code> æ–‡æœ¬ç¼–è¾‘å™¨æŸ¥çœ‹ class æ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œå…·ä½“å†…å®¹å¦‚ä¸‹ï¼Œé€šè¿‡æ¯”å¯¹èƒ½å¤Ÿæ‰¾åˆ° <code>main</code> æ–¹æ³•å¯¹åº”çš„ 16 è¿›åˆ¶å†…å®¹â€”â€”<code>bb00 0759 b700 094c 2bb6 000a b1</code>ã€‚</p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology/hello-byte-code-class.png" title="HelloByteCode Class å†…å®¹"><p><code>main</code> æ–¹æ³•ä¸­å…¶ä»–çš„ <code>LineNumberTable</code> å’Œ <code>LocalVariableTable</code>ï¼Œå’Œå‰æ–‡ä»‹ç»çš„å†…å®¹åŸºæœ¬ä¸€è‡´ï¼Œæ„Ÿå…´è¶£çš„è¯»è€…å¯ä»¥è‡ªè¡Œå°è¯•ç†è§£ï¼Œæœ¬å°èŠ‚å°±ä¸å†ä¸€ä¸€ä»‹ç»ã€‚</p><h4 id="sayhello-æ–¹æ³•"><a class="markdownIt-Anchor" href="#sayhello-æ–¹æ³•"></a> sayHello æ–¹æ³•</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">sayHello</span><span class="params">()</span>;</span><br><span class="line">  descriptor: ()V</span><br><span class="line">  flags: (<span class="number">0x0002</span>) ACC_PRIVATE</span><br><span class="line">  Code:</span><br><span class="line">    stack=<span class="number">2</span>, locals=<span class="number">1</span>, args_size=<span class="number">1</span></span><br><span class="line">       <span class="number">0</span>: getstatic     #<span class="number">13</span>                 <span class="comment">// Field java/lang/System.out:Ljava/io/PrintStream;</span></span><br><span class="line">       <span class="number">3</span>: ldc           #<span class="number">19</span>                 <span class="comment">// String Hello, ByteCode!</span></span><br><span class="line">       <span class="number">5</span>: invokevirtual #<span class="number">21</span>                 <span class="comment">// Method java/io/PrintStream.println:(Ljava/lang/String;)V</span></span><br><span class="line">       <span class="number">8</span>: <span class="keyword">return</span></span><br><span class="line">    LineNumberTable:</span><br><span class="line">      line <span class="number">11</span>: <span class="number">0</span></span><br><span class="line">      line <span class="number">12</span>: <span class="number">8</span></span><br><span class="line">    LocalVariableTable:</span><br><span class="line">      Start  Length  Slot  Name   Signature</span><br><span class="line">          <span class="number">0</span>       <span class="number">9</span>     <span class="number">0</span>  <span class="built_in">this</span>   Lcom/strongduanmu/jvm/bytecode/HelloByteCode;</span><br></pre></td></tr></table></figure><p>æœ€åï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸‹ <code>sayHello</code> æ–¹æ³•ï¼Œå’Œæ„é€ æ–¹æ³•åŠ <code>main</code> æ–¹æ³•ä¸åŒçš„æ˜¯ï¼Œ<code>sayHello</code> æ–¹æ³•æ˜¯ä¸€ä¸ªç§æœ‰æ–¹æ³•ï¼Œå› æ­¤ <code>flags</code> å¯¹åº”çš„æ˜¯ <code>ACC_PRIVATE</code>ã€‚</p><p><code>Code</code> éƒ¨åˆ†ï¼Œ<code>sayHello</code> æ–¹æ³•ä½¿ç”¨åˆ°äº† <code>getstatic</code> å’Œ <code>ldc</code> ä¸¤ä¸ªæ“ä½œç ï¼Œ<code>getstatic</code> æ“ä½œç è¡¨ç¤ºè·å–æŒ‡å®šç±»çš„é™æ€åŸŸï¼Œå¹¶å°†å…¶å‹å…¥æ ˆé¡¶ï¼Œæ­¤å¤„è¡¨ç¤ºå¯¹ <code>System</code> ç±»ä¸­çš„é™æ€æˆå‘˜å˜é‡ <code>PrintStream out</code> çš„è°ƒç”¨ã€‚<code>ldc</code> æ“ä½œç è¡¨ç¤ºå°† intï¼Œfloat æˆ– String å‹å¸¸é‡å€¼ä»å¸¸é‡æ± ä¸­æ¨è‡³æ ˆé¡¶ï¼Œæ­¤å¤„æŒ‡å°†å­—ç¬¦ä¸²å¸¸é‡ <code>Hello, ByteCode!</code> æ¨è‡³æ ˆé¡¶ã€‚<code>invokevirtual</code> æ“ä½œç å‰æ–‡å·²ç»ä»‹ç»ï¼Œè¡¨ç¤ºè°ƒç”¨å®ä¾‹æ–¹æ³•ï¼Œæ­¤å¤„è¡¨ç¤ºè°ƒç”¨ PrintStream å¯¹è±¡çš„ <code>println</code> æ–¹æ³•ã€‚</p><h3 id="sourcefile"><a class="markdownIt-Anchor" href="#sourcefile"></a> SourceFile</h3><p><code>SourceFile</code> å†…å®¹æ¯”è¾ƒç®€å•ï¼Œç”¨äºå£°æ˜å½“å‰ class æ–‡ä»¶çš„æºæ–‡ä»¶ï¼Œæ­¤å¤„ä¸º <code>HelloByteCode.java</code>ã€‚</p><h2 id="å­—èŠ‚ç æ‰§è¡Œè¿‡ç¨‹"><a class="markdownIt-Anchor" href="#å­—èŠ‚ç æ‰§è¡Œè¿‡ç¨‹"></a> å­—èŠ‚ç æ‰§è¡Œè¿‡ç¨‹</h2><h3 id="æŠ½è±¡æ‰§è¡Œæµç¨‹"><a class="markdownIt-Anchor" href="#æŠ½è±¡æ‰§è¡Œæµç¨‹"></a> æŠ½è±¡æ‰§è¡Œæµç¨‹</h3><p>å‰æ–‡æˆ‘ä»¬è¯¦ç»†ä»‹ç»äº† <code>javap</code> å‘½ä»¤å±•ç¤ºå­—èŠ‚ç ä¿¡æ¯çš„å…·ä½“å«ä¹‰ï¼Œæœ¬èŠ‚æˆ‘ä»¬å†æ¥äº†è§£ä¸‹å­—èŠ‚ç çš„æ‰§è¡Œè¿‡ç¨‹ã€‚å¦‚æœä¸è€ƒè™‘ JVM ä¸­çš„å¼‚å¸¸å¤„ç†é€»è¾‘ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢çš„ä¼ªä»£ç æ¥è¡¨ç¤ºå­—èŠ‚ç çš„æ‰§è¡Œè¿‡ç¨‹ã€‚é¦–å…ˆï¼ŒJVM ä¼šè‡ªåŠ¨è®¡ç®— PC ç¨‹åºè®¡æ•°å™¨çš„å€¼è¿›è¡ŒåŠ  1ï¼Œç„¶åæ ¹æ® PC ç¨‹åºè®¡æ•°å™¨æŒ‡ç¤ºçš„ä½ç½®ï¼Œè¯»å–å­—èŠ‚ç æµä¸­çš„æ“ä½œç ï¼Œç”±äºå­—èŠ‚ç ä¸­ä¸€äº›æ“ä½œç åé¢å­˜åœ¨æ“ä½œæ•°ï¼Œå› æ­¤ä¼šåˆ¤æ–­å½“å‰æ“ä½œç æ˜¯å¦å­˜åœ¨æ“ä½œæ•°ï¼Œå­˜åœ¨åˆ™ç»§ç»­è¯»å–æ“ä½œæ•°ï¼Œä¸å­˜åœ¨æˆ–è€…è¯»å–å®Œåˆ™æ‰§è¡Œ<strong>æŒ‡ä»¤ï¼ˆæ“ä½œç  + æ“ä½œæ•°ï¼‰</strong>ï¼Œæ‰§è¡Œå®Œæˆåç»§ç»­è¯»å–å‰©ä½™çš„å­—èŠ‚ç å†…å®¹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">    è‡ªåŠ¨è®¡ç®— PC ç¨‹åºè®¡æ•°å™¨çš„å€¼åŠ  <span class="number">1</span>;</span><br><span class="line">  	æ ¹æ® PC ç¨‹åºè®¡æ•°å™¨æŒ‡ç¤ºçš„ä½ç½®ï¼Œä»å­—èŠ‚ç æµä¸­å–å‡ºæ“ä½œç ; </span><br><span class="line">  	<span class="keyword">if</span> (å­—èŠ‚ç å­˜åœ¨æ“ä½œæ•°) </span><br><span class="line">      	ä»å­—èŠ‚ç æµä¸­å–å‡ºæ“ä½œæ•°;</span><br><span class="line">    æ‰§è¡Œæ“ä½œç æ‰€å®šä¹‰çš„æ“ä½œ;</span><br><span class="line">&#125; <span class="keyword">while</span> (å­—èŠ‚ç æµé•¿åº¦ &gt; <span class="number">0</span>);</span><br></pre></td></tr></table></figure><h3 id="æ‰§è¡Œæµç¨‹è¯´æ˜"><a class="markdownIt-Anchor" href="#æ‰§è¡Œæµç¨‹è¯´æ˜"></a> æ‰§è¡Œæµç¨‹è¯´æ˜</h3><p>äº†è§£äº†å­—èŠ‚ç æŠ½è±¡æ‰§è¡Œæµç¨‹ï¼Œæˆ‘ä»¬å†ç»“åˆä¸‹é¢çš„ <a target="_blank" rel="noopener" href="https://github.com/strongduanmu/jvm-lecture/blob/d0acead7a97151f75eec1a7ddb22131f4704b7fe/src/main/java/com/strongduanmu/jvm/bytecode/BasicCalculator.java">BasicCalculator</a> ç¤ºä¾‹ï¼Œæ¥è§‚å¯Ÿä¸‹å…·ä½“æ¯ä¸ªå­—èŠ‚ç æ‰§è¡Œæ—¶ï¼Œå±€éƒ¨å˜é‡è¡¨å’Œæ“ä½œæ ˆä¹‹é—´çš„äº¤äº’å˜åŒ–ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">BasicCalculator</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        System.out.println(<span class="keyword">new</span> <span class="title class_">BasicCalculator</span>().calculate());</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="title function_">calculate</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> <span class="number">100</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">b</span> <span class="operator">=</span> <span class="number">200</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">c</span> <span class="operator">=</span> <span class="number">300</span>;</span><br><span class="line">        <span class="keyword">return</span> (a + b) * c;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬åˆ†åˆ«ä½¿ç”¨ <code>javac -g BasicCalculator.java</code> å’Œ <code>javap -c -v -p BasicCalculator</code> ç¼–è¯‘å’ŒæŸ¥çœ‹å­—èŠ‚ç ä¿¡æ¯ï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹çš„æ ¸å¿ƒé€»è¾‘ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="type">int</span> <span class="title function_">calculate</span><span class="params">()</span>;</span><br><span class="line">  descriptor: ()I</span><br><span class="line">  flags: (<span class="number">0x0002</span>) ACC_PRIVATE</span><br><span class="line">  Code:</span><br><span class="line">    stack=<span class="number">2</span>, locals=<span class="number">4</span>, args_size=<span class="number">1</span></span><br><span class="line">       <span class="number">0</span>: bipush        <span class="number">100</span></span><br><span class="line">       <span class="number">2</span>: istore_1</span><br><span class="line">       <span class="number">3</span>: sipush        <span class="number">200</span></span><br><span class="line">       <span class="number">6</span>: istore_2</span><br><span class="line">       <span class="number">7</span>: sipush        <span class="number">300</span></span><br><span class="line">      <span class="number">10</span>: istore_3</span><br><span class="line">      <span class="number">11</span>: iload_1</span><br><span class="line">      <span class="number">12</span>: iload_2</span><br><span class="line">      <span class="number">13</span>: iadd</span><br><span class="line">      <span class="number">14</span>: iload_3</span><br><span class="line">      <span class="number">15</span>: imul</span><br><span class="line">      <span class="number">16</span>: ireturn</span><br><span class="line">    LineNumberTable:</span><br><span class="line">      line <span class="number">10</span>: <span class="number">0</span></span><br><span class="line">      line <span class="number">11</span>: <span class="number">3</span></span><br><span class="line">      line <span class="number">12</span>: <span class="number">7</span></span><br><span class="line">      line <span class="number">13</span>: <span class="number">11</span></span><br><span class="line">    LocalVariableTable:</span><br><span class="line">      Start  Length  Slot  Name   Signature</span><br><span class="line">          <span class="number">0</span>      <span class="number">17</span>     <span class="number">0</span>  <span class="built_in">this</span>   Lcom/strongduanmu/jvm/bytecode/BasicCalculator;</span><br><span class="line">          <span class="number">3</span>      <span class="number">14</span>     <span class="number">1</span>     a   I</span><br><span class="line">          <span class="number">7</span>      <span class="number">10</span>     <span class="number">2</span>     b   I</span><br><span class="line">         <span class="number">11</span>       <span class="number">6</span>     <span class="number">3</span>     c   I</span><br></pre></td></tr></table></figure><p>ä»å­—èŠ‚ç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œè¿™æ®µè®¡ç®—é€»è¾‘æ€»å…±åŒ…å«äº† 4 ä¸ªæœ¬åœ°å˜é‡ï¼Œåˆ†åˆ«æ˜¯ï¼š<code>this</code>ã€<code>a</code>ã€<code>b</code> å’Œ <code>c</code>ï¼Œæ‰§è¡Œè®¡ç®—é€»è¾‘æ—¶ï¼Œå¤šæ¬¡è°ƒç”¨äº† <code>push</code> å’Œ <code>store</code> æŒ‡ä»¤ï¼Œä¸‹é¢æˆ‘ä»¬å°†é’ˆå¯¹å­—èŠ‚ç ä¸­çš„æ¯ä¸ªæŒ‡ä»¤è¿›è¡Œé€ä¸ªåˆ†æã€‚</p><ul><li><strong>æ‰§è¡Œ bipush 100 æŒ‡ä»¤ï¼š</strong></li></ul><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology/bytecode-execute-progress-bipush-100.png" title="æ‰§è¡Œ bipush 100 æŒ‡ä»¤"><p>é¦–å…ˆï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹ç¬¬ 1 ä¸ªæŒ‡ä»¤ <code>bipush</code>ï¼Œå®ƒè¡¨ç¤ºå°†å•å­—èŠ‚çš„å¸¸é‡å€¼ï¼ˆ<code>-128 ~ 127</code>ï¼‰æ¨è‡³æ ˆé¡¶ï¼Œæ­¤æ¡ˆä¾‹æ˜¯å°† 100 æ¨è‡³æ ˆé¡¶ã€‚ä¸Šå›¾å±•ç¤ºäº†ç¨‹åºè®¡æ•°å™¨ã€å±€éƒ¨å˜é‡è¡¨å’Œæ“ä½œæ ˆçš„çŠ¶æ€ï¼Œç¨‹åºè®¡æ•°å™¨æŒ‡å‘äº†å½“å‰éœ€è¦æ‰§è¡Œå­—èŠ‚ç çš„ä½ç½® 0ï¼ŒJVM é¦–å…ˆä¼šè¯»å– bipush æ“ä½œç ï¼Œç”±äºè¯¥æ“ä½œç åŒ…å«äº† 1 ä¸ªå­—èŠ‚çš„æ“ä½œæ•°ï¼Œå› æ­¤ä¼šç»§ç»­è¯»å–å¯¹åº”çš„å€¼ 100ï¼Œè¯»å–å®Œæˆåæ‰§è¡ŒæŒ‡ä»¤ï¼Œä¼šå°† 100 æ¨è‡³æ“ä½œæ ˆçš„æ ˆé¡¶ã€‚</p><ul><li><strong>æ‰§è¡Œ istore_1 æŒ‡ä»¤ï¼š</strong></li></ul><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology/bytecode-execute-progress-istore_1.png" title="æ‰§è¡Œ istore_1 æŒ‡ä»¤"><p>ç„¶å JVM ä¼šç»§ç»­æ‰§è¡Œ <code>istore_1</code> æŒ‡ä»¤ï¼Œè¯¥æŒ‡ä»¤è¡¨ç¤ºå°†æ ˆé¡¶ int å‹æ•°å€¼å­˜å…¥ç¬¬äºŒä¸ªæœ¬åœ°å˜é‡ï¼Œå³ä¸Šå›¾æ‰€ç¤ºçš„ a å˜é‡ä¸­ã€‚</p><ul><li><strong>æ‰§è¡Œ sipush 200 æŒ‡ä»¤ï¼š</strong></li></ul><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology/bytecode-execute-progress-sipush-200.png" title="æ‰§è¡Œ sipush 200 æŒ‡ä»¤"><p>æ ¹æ®ç¨‹åºè®¡æ•°å™¨æŒ‡ç¤ºçš„ä½ç½® 3ï¼ŒJVM ä¼šç»§ç»­æ‰§è¡Œå¯¹åº”çš„ <code>sipush</code> æŒ‡ä»¤ï¼Œè¯¥æŒ‡ä»¤ä¼šå°†çŸ­æ•´å‹å¸¸é‡ï¼ˆ<code>-32768 ~ 32767</code>ï¼‰æ¨è‡³æ ˆé¡¶ï¼Œæ­¤å¤„ä¼šå°† 200 æ¨è‡³æ“ä½œæ ˆçš„æ ˆé¡¶ã€‚æ‰§è¡Œå®Œæˆåç¨‹åºè®¡æ•°å™¨ä¼šå˜æ›´ä¸º 6ï¼Œå› ä¸ºæ“ä½œç  <code>sipush</code> å ç”¨ 1 ä¸ªå­—èŠ‚ï¼Œæ“ä½œæ•° <code>200</code> å ç”¨ 2 ä¸ªå­—èŠ‚ã€‚</p><ul><li><strong>æ‰§è¡Œ istore_2 æŒ‡ä»¤ï¼š</strong></li></ul><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology/bytecode-execute-progress-istore_2.png" title="æ‰§è¡Œ istore_2 æŒ‡ä»¤"><p>JVM ç»§ç»­æ‰§è¡Œ <code>istore_2</code> æŒ‡ä»¤ï¼Œè¯¥æŒ‡ä»¤ä¼šå°†æ ˆé¡¶ int å‹æ•°å€¼å­˜å…¥ç¬¬ä¸‰ä¸ªæœ¬åœ°å˜é‡ï¼Œå³ä¸Šå›¾æ‰€ç¤ºçš„ b å˜é‡ã€‚</p><ul><li><strong>æ‰§è¡Œ sipush 300 æŒ‡ä»¤ï¼š</strong></li></ul><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology/bytecode-execute-progress-sipush-300.png" title="æ‰§è¡Œ sipush 300 æŒ‡ä»¤"><p><code>sipush</code> æŒ‡ä»¤å‰æ–‡å·²ç»ä»‹ç»å…¶ä½œç”¨ï¼Œæ­¤å¤„åªæœ‰æ“ä½œæ•°ä¸åŒï¼Œè¯¥æŒ‡ä»¤ä¼šå°† 300 å‹å…¥åˆ°æ ˆé¡¶ã€‚</p><ul><li><strong>æ‰§è¡Œ istore_3 æŒ‡ä»¤ï¼š</strong></li></ul><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology/bytecode-execute-progress-istore_3.png" title="æ‰§è¡Œ istore_3 æŒ‡ä»¤"><p>æ ¹æ®ç¨‹åºè®¡æ•°å™¨æŒ‡ç¤ºçš„ä½ç½® 10ï¼ŒJVM ä¼šæ‰§è¡Œ <code>istore_3</code> æŒ‡ä»¤ï¼Œè¯¥æŒ‡ä»¤ä¼šå°†æ ˆé¡¶ int å‹æ•°å€¼å­˜å…¥ç¬¬å››ä¸ªæœ¬åœ°å˜é‡ï¼Œå³å­˜å…¥å˜é‡ c çš„ä½ç½®ã€‚</p><ul><li><strong>æ‰§è¡Œ iload_1 æŒ‡ä»¤ï¼š</strong></li></ul><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology/bytecode-execute-progress-iload_1.png" title="æ‰§è¡Œ iload_1 æŒ‡ä»¤"><p>ç¨‹åºè®¡æ•°å™¨ 11 ä½ç½®æŒ‡å‘äº† <code>iload_1</code> æŒ‡ä»¤ï¼Œè¯¥æŒ‡ä»¤è¡¨ç¤ºå°†ç¬¬äºŒä¸ª int å‹æœ¬åœ°å˜é‡æ¨è‡³æ ˆé¡¶ï¼Œä¸Šå›¾å±•ç¤ºäº†å°†å˜é‡ a çš„å€¼ 100 æ¨è‡³æ ˆé¡¶çš„è¿‡ç¨‹ã€‚</p><ul><li><strong>æ‰§è¡Œ iload_2 æŒ‡ä»¤ï¼š</strong></li></ul><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology/bytecode-execute-progress-iload_2.png" title="æ‰§è¡Œ iload_2 æŒ‡ä»¤"><p>ç¨‹åºè®¡æ•°å™¨ 12 ä½ç½®æŒ‡å‘äº† <code>iload_2</code> æŒ‡ä»¤ï¼Œè¯¥æŒ‡ä»¤è¡¨ç¤ºå°†ç¬¬ä¸‰ä¸ª int å‹æœ¬åœ°å˜é‡æ¨è‡³æ ˆé¡¶ï¼Œä¸Šå›¾å±•ç¤ºäº†å°†å˜é‡ b çš„å€¼ 200 æ¨è‡³æ ˆé¡¶çš„è¿‡ç¨‹ã€‚</p><ul><li><strong>æ‰§è¡Œ iadd æŒ‡ä»¤ï¼š</strong></li></ul><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology/bytecode-execute-progress-iadd.png" title="æ‰§è¡Œ iadd æŒ‡ä»¤"><p>ç¨‹åºè®¡æ•°å™¨ 13 ä½ç½®æŒ‡å‘äº† <code>iadd</code> æŒ‡ä»¤ï¼Œè¯¥æŒ‡ä»¤è¡¨ç¤ºå°†æ ˆé¡¶ä¸¤ int å‹æ•°å€¼ç›¸åŠ å¹¶å°†ç»“æœå‹å…¥æ ˆé¡¶ï¼Œä¸Šå›¾å±•ç¤ºäº†å°†æ ˆé¡¶çš„ 100 å’Œ 200 ç›¸åŠ ï¼Œå¹¶å°†ç»“æœ 300 å‹å…¥æ ˆé¡¶çš„è¿‡ç¨‹ã€‚</p><ul><li><strong>æ‰§è¡Œ iload_3 æŒ‡ä»¤ï¼š</strong></li></ul><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology/bytecode-execute-progress-iload_3.png" title="æ‰§è¡Œ iload_3 æŒ‡ä»¤"><p>ç¨‹åºè®¡æ•°å™¨ 14 ä½ç½®æŒ‡å‘äº† <code>iload_3</code> æŒ‡ä»¤ï¼Œè¯¥æŒ‡ä»¤è¡¨ç¤ºå°†ç¬¬å››ä¸ª int å‹æœ¬åœ°å˜é‡æ¨è‡³æ ˆé¡¶ï¼Œä¸Šå›¾å±•ç¤ºäº†å°†å˜é‡ c çš„å€¼ 300 æ¨è‡³æ ˆé¡¶çš„è¿‡ç¨‹ã€‚</p><ul><li><strong>æ‰§è¡Œ imul æŒ‡ä»¤ï¼š</strong></li></ul><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology/bytecode-execute-progress-imul.png" title="æ‰§è¡Œ imul æŒ‡ä»¤"><p>ç¨‹åºè®¡æ•°å™¨ 15 ä½ç½®æŒ‡å‘äº† <code>imul</code> æŒ‡ä»¤ï¼Œè¯¥æŒ‡ä»¤è¡¨ç¤ºå°†æ ˆé¡¶ä¸¤ int å‹æ•°å€¼ç›¸ä¹˜å¹¶å°†ç»“æœå‹å…¥æ ˆé¡¶ï¼Œä¸Šå›¾å±•ç¤ºäº†å°†æ ˆé¡¶çš„ 300 å’Œ 300 ç›¸ä¹˜ï¼Œå¹¶å°†ç»“æœ 90000 å‹å…¥æ ˆé¡¶çš„è¿‡ç¨‹ã€‚</p><ul><li><strong>æ‰§è¡Œ ireturn æŒ‡ä»¤ï¼š</strong></li></ul><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology/bytecode-execute-progress-ireturn.png" title="æ‰§è¡Œ ireturn æŒ‡ä»¤"><p>ç¨‹åºè®¡æ•°å™¨ 16 ä½ç½®æŒ‡å‘äº† <code>ireturn</code> æŒ‡ä»¤ï¼Œè¯¥æŒ‡ä»¤è¡¨ç¤ºä»å½“å‰æ–¹æ³•è¿”å› intï¼Œä¸Šå›¾å±•ç¤ºäº†å°†æ ˆé¡¶çš„ 90000 è¿”å›ç»™è°ƒç”¨é€»è¾‘çš„è¿‡ç¨‹ã€‚</p><p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å°±è¯¦ç»†ä»‹ç»äº†ç¤ºä¾‹è®¡ç®—é€»è¾‘æ‰§è¡Œæ—¶ï¼Œç¨‹åºè®¡æ•°å™¨ã€å±€éƒ¨å˜é‡è¡¨ä»¥åŠæ“ä½œæ ˆä¹‹é—´çš„å˜åŒ–ï¼Œè™½ç„¶è¿™ä¸ªç¤ºä¾‹è¾ƒä¸ºç®€å•ï¼Œä½†æ˜¯å®ƒå·²ç»å¾ˆå¥½åœ°å±•ç¤ºäº†å­—èŠ‚ç æ‰§è¡Œçš„è¿‡ç¨‹ã€‚å¦‚æœå¤§å®¶æ„Ÿå…´è¶£ï¼Œå¯ä»¥<strong>å°è¯•é‡‡ç”¨ä¸Šé¢çš„æ–¹å¼æ¥ç†è§£æ›´å¤æ‚çš„ä¸šåŠ¡é€»è¾‘</strong>ã€‚</p><h2 id="å¸¸ç”¨å­—èŠ‚ç æŒ‡ä»¤"><a class="markdownIt-Anchor" href="#å¸¸ç”¨å­—èŠ‚ç æŒ‡ä»¤"></a> å¸¸ç”¨å­—èŠ‚ç æŒ‡ä»¤</h2><p>æœ€åä¸€ä¸ªéƒ¨åˆ†ï¼Œæˆ‘ä»¬å†æ¥ä»‹ç»ä¸‹å¸¸ç”¨çš„å­—èŠ‚ç æŒ‡ä»¤ï¼Œå¸®åŠ©å¤§å®¶èƒ½å¤Ÿåœ¨å®é™…é¡¹ç›®ä¸­çœ‹æ‡‚æ›´åŠ å¤æ‚çš„å­—èŠ‚ç æŒ‡ä»¤å«ä¹‰ã€‚æ–‡ç« ä¸€å¼€å§‹ï¼Œæˆ‘ä»¬å°±ä»‹ç»äº†å­—èŠ‚ç æŒ‡ä»¤åŒ…æ‹¬äº†ï¼š<code>æ ˆæ“ä½œæŒ‡ä»¤</code>ã€<code>æµç¨‹æ§åˆ¶æŒ‡ä»¤</code>ã€<code>æµç¨‹æ§åˆ¶æŒ‡ä»¤</code> å’Œ <code>ç®—æœ¯è¿ç®—åŠç±»å‹è½¬æ¢æŒ‡ä»¤</code> 4 å¤§ç±»ï¼Œé™¤äº†è¿™ 4 å¤§ç±»ï¼Œ<code>å¯¹è±¡åˆå§‹åŒ–æŒ‡ä»¤</code> ä¹ŸåŒæ ·é‡è¦ï¼Œä¸‹é¢æˆ‘ä»¬å°†æŒ‰ç…§è¿™å‡ å¤§ç±»ï¼Œä¸ºå¤§å®¶ä»‹ç»å¸¸ç”¨çš„å­—èŠ‚ç æŒ‡ä»¤ã€‚</p><h3 id="å¯¹è±¡åˆå§‹åŒ–æŒ‡ä»¤"><a class="markdownIt-Anchor" href="#å¯¹è±¡åˆå§‹åŒ–æŒ‡ä»¤"></a> å¯¹è±¡åˆå§‹åŒ–æŒ‡ä»¤</h3><p>é€šè¿‡ <code>new HelloByteCode()</code> è¿›è¡Œå¯¹è±¡åˆå§‹åŒ–ï¼Œæ˜¯å¤§å®¶æ—¥å¸¸å¼€å‘çš„å¸¸ç”¨æ“ä½œï¼Œé€šè¿‡å‰æ–‡çš„ç¤ºä¾‹æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå¯¹è±¡åˆå§‹åŒ–æ“ä½œé€šå¸¸å¯ä»¥å¯¹åº”å¦‚ä¸‹çš„ 3 ä¸ª JVM æŒ‡ä»¤ï¼Œåˆ†åˆ«æ˜¯ <code>new</code>ã€<code>dup</code> å’Œ <code>invokespecial</code>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>: <span class="keyword">new</span>           #<span class="number">7</span>                  <span class="comment">// class com/strongduanmu/jvm/bytecode/HelloByteCode</span></span><br><span class="line"><span class="number">3</span>: dup</span><br><span class="line"><span class="number">4</span>: invokespecial #<span class="number">9</span>                  <span class="comment">// Method &quot;&lt;init&gt;&quot;:()V</span></span><br></pre></td></tr></table></figure><p>é‚£ä¸ºä»€ä¹ˆéœ€è¦ 3 æ¡æŒ‡ä»¤æ‰èƒ½å®Œæˆå¯¹è±¡åˆå§‹åŒ–å‘¢ï¼Ÿæ˜¯å› ä¸ºï¼š</p><ul><li>å­—èŠ‚ç ä¸­çš„ <code>new</code> æŒ‡ä»¤åªè´Ÿè´£åˆ›å»ºå¯¹è±¡ï¼Œå¹¶å°†å¯¹è±¡å¼•ç”¨å‹å…¥æ ˆé¡¶ï¼Œ<code>new</code> æŒ‡ä»¤ä¸ä¼šè°ƒç”¨å¯¹è±¡çš„æ„é€ æ–¹æ³•ï¼›</li><li><code>dup</code> æŒ‡ä»¤ç”¨äºå¤åˆ¶æ ˆé¡¶çš„å€¼ï¼Œæ­¤æ—¶æ“ä½œæ ˆä¸Šä¼šå‡ºç°è¿ç»­ç›¸åŒçš„ä¸¤ä¸ªå¯¹è±¡å¼•ç”¨ï¼Œ<code>dup</code> å¤åˆ¶çš„å¯¹è±¡å¼•ç”¨ä¼šç”¨äºä¸‹ä¸€æ­¥ <code>invokespecial</code> æŒ‡ä»¤æ‰§è¡Œï¼Œè€Œ <code>new</code> æŒ‡ä»¤åˆ›å»ºçš„å¯¹è±¡å¼•ç”¨åˆ™ä¼šç”¨äºæ­£å¸¸ä»£ç é€»è¾‘è°ƒç”¨ï¼›</li><li>è°ƒç”¨æ„é€ æ–¹æ³•æ˜¯ç”± <code>invokespecial</code> æŒ‡ä»¤æ¥å®Œæˆï¼Œæ­¤å¤„ä¼šè°ƒç”¨ <code>HelloByteCode#init</code> å®ä¾‹æ–¹æ³•ï¼Œå› æ­¤éœ€è¦ä»æ“ä½œæ ˆä¸Šå¼¹å‡º <code>this</code> å¯¹è±¡ã€‚</li></ul><p>åœ¨å®Œæˆå¯¹è±¡åˆå§‹åŒ–åï¼Œé€šå¸¸ä¼šå°†å¯¹è±¡å®ä¾‹èµ‹ç»™å±€éƒ¨å˜é‡æˆ–å…¨å±€å˜é‡ï¼Œå› æ­¤ï¼Œç´§éšå…¶åçš„æŒ‡ä»¤å¯èƒ½æœ‰å¦‚ä¸‹å‡ ç§ï¼š</p><ul><li><code>astore_&#123;n&#125;</code> æˆ– <code>astore &#123;n&#125;</code>ï¼Œ<code>&#123;n&#125;</code> è¡¨ç¤ºæœ¬åœ°å˜é‡è¡¨ä¸­çš„ä½ç½®ï¼Œè¯¥å‘½ä»¤ä¼šå°†å¯¹è±¡å­˜å‚¨åˆ°æœ¬åœ°å˜é‡è¡¨çš„æŒ‡å®šä½ç½®ï¼›</li><li><code>putfield</code> å°†å¯¹è±¡èµ‹å€¼ç»™å®ä¾‹å˜é‡ï¼›</li><li><code>putstatic</code> å°†å¯¹è±¡èµ‹å€¼ç»™é™æ€å˜é‡ã€‚</li></ul><h3 id="æ ˆæ“ä½œæŒ‡ä»¤"><a class="markdownIt-Anchor" href="#æ ˆæ“ä½œæŒ‡ä»¤"></a> æ ˆæ“ä½œæŒ‡ä»¤</h3><p>å‰æ–‡æˆ‘ä»¬ä»‹ç»å¯¹è±¡åˆå§‹åŒ–æ—¶æåˆ°äº† <code>dup</code> æŒ‡ä»¤ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªæ ˆæ“ä½œæŒ‡ä»¤ï¼Œé™¤äº† <code>dup</code> æŒ‡ä»¤å¤–ï¼Œæ ˆæ“ä½œæŒ‡ä»¤è¿˜åŒ…æ‹¬ï¼š<code>pop</code>ã€<code>pop2</code>ã€<code>dup_x1</code>ã€<code>dup_x2</code>ã€<code>dup2</code>ã€<code>dup2_x1</code>ã€<code>dup2_x2</code> å’Œ <code>swap</code> æŒ‡ä»¤ã€‚</p><p><code>dup</code>ã€<code>dup2</code>ã€<code>pop</code> å’Œ <code>pop2</code> æ˜¯æœ€åŸºç¡€çš„æ ˆæ“ä½œæŒ‡ä»¤ï¼Œå®ƒä»¬çš„ä½œç”¨å¦‚ä¸‹ï¼š</p><ul><li><code>dup</code> ç”¨äºå¤åˆ¶æ ˆé¡¶æ•°å€¼ï¼Œå¹¶å°†å¤åˆ¶å€¼å‹å…¥æ ˆé¡¶ï¼Œdup æŒ‡ä»¤åªèƒ½é€‚ç”¨äºä¸‹è¡¨åˆ†ç±» 1 çš„ç±»å‹ï¼Œè¿™äº›ç±»å‹åªå ç”¨ä¸€ä¸ªæ§½ä½ Slotï¼›</li><li><code>dup2</code> ç”¨äºå¤åˆ¶æ ˆé¡¶ä¸€ä¸ª longã€double ç±»å‹ï¼Œæˆ–è€…ä¸¤ä¸ªé longã€é double çš„å…¶ä»–ç±»å‹æ•°å€¼ï¼Œå¹¶å°†å¤åˆ¶å€¼å‹å…¥æ ˆé¡¶ï¼ˆlongã€double ç±»å‹å ç”¨ä¸¤ä¸ªæ§½ä½ Slotï¼‰ï¼›</li><li><code>pop</code> å°†æ ˆé¡¶æ•°å€¼å¼¹å‡ºï¼Œpop æŒ‡ä»¤åªèƒ½é€‚ç”¨äºä¸‹è¡¨åˆ†ç±» 1 çš„ç±»å‹ï¼Œè¿™äº›ç±»å‹åªå ç”¨ä¸€ä¸ªæ§½ä½ Slotï¼›</li><li><code>pop2</code> å°†æ ˆé¡¶çš„ä¸€ä¸ª longã€double ç±»å‹ï¼Œæˆ–è€…ä¸¤ä¸ªé longã€é double çš„å…¶ä»–ç±»å‹æ•°å€¼å¼¹å‡ºï¼ˆlongã€double ç±»å‹å ç”¨ä¸¤ä¸ªæ§½ä½ Slotï¼‰ã€‚</li></ul><table><thead><tr><th>å®é™…ç±»å‹</th><th>JVM è®¡ç®—ç±»å‹</th><th>åˆ†ç±»</th></tr></thead><tbody><tr><td><code>boolean</code></td><td><code>int</code></td><td>1</td></tr><tr><td><code>byte</code></td><td><code>int</code></td><td>1</td></tr><tr><td><code>char</code></td><td><code>int</code></td><td>1</td></tr><tr><td><code>short</code></td><td><code>int</code></td><td>1</td></tr><tr><td><code>int</code></td><td><code>int</code></td><td>1</td></tr><tr><td><code>float</code></td><td><code>float</code></td><td>1</td></tr><tr><td><code>reference</code></td><td><code>reference</code></td><td>1</td></tr><tr><td><code>returnAddress</code></td><td><code>returnAddress</code></td><td>1</td></tr><tr><td><code>long</code></td><td><code>long</code></td><td>2</td></tr><tr><td><code>double</code></td><td><code>double</code></td><td>2</td></tr></tbody></table><p><code>dup_x1</code>ã€<code>dup_x2</code>ã€<code>dup2_x1</code>ã€<code>dup2_x2</code> è¿™å‡ ä¸ªæŒ‡ä»¤ä¼šç¨å¾®å¤æ‚ä¸€äº›ï¼Œå‰ç¼€éƒ¨åˆ†çš„ <code>dup</code> å’Œ <code>dup2</code> å’Œå‰é¢ä»‹ç»çš„æŒ‡ä»¤å«ä¹‰ç›¸åŒï¼Œè¡¨ç¤ºå¤åˆ¶ 1 ä¸ªå’Œ 2 ä¸ªæ§½ä½ Slot æ•°å€¼ï¼Œåç¼€ <code>_x&#123;n&#125;</code> ä»£è¡¨å°†æ ˆé¡¶å¤åˆ¶çš„å€¼æ’å…¥åˆ°æ ˆçš„æŒ‡å®šä½ç½®ï¼Œæˆ‘ä»¬åªéœ€å°†æŒ‡ä»¤çš„ <code>dup</code> å’Œ <code>_x&#123;n&#125;</code> ä¸­çš„ç³»æ•°ç›¸åŠ ï¼Œç»“æœå³ä¸ºéœ€è¦æ’å…¥çš„ä½ç½®ï¼Œä¾‹å¦‚ï¼š</p><ul><li><code>dup_x1</code> æ’å…¥ä½ç½®ä¸º <code>1 + 1 = 2</code>ï¼Œå³æ ˆé¡¶ 2 ä¸ª Slot ä¸‹çš„ä½ç½®ï¼›</li><li><code>dup_x2</code> æ’å…¥ä½ç½®ä¸º <code>1 + 2 = 3</code>ï¼Œå³æ ˆé¡¶ 3 ä¸ª Slot ä¸‹çš„ä½ç½®ï¼›</li><li><code>dup2_x1</code> æ’å…¥ä½ç½®ä¸º <code>2 + 1 = 3</code>ï¼Œå³æ ˆé¡¶ 3 ä¸ª Slotä¸‹çš„ä½ç½®ï¼›</li><li><code>dup2_x2</code> æ’å…¥ä½ç½®ä¸º <code>2 + 2 = 4</code>ï¼Œå³æ ˆé¡¶ 4 ä¸ª Slot ä¸‹çš„ä½ç½®ã€‚</li></ul><p><code>swap</code> æŒ‡ä»¤è¡¨ç¤ºå°†æ ˆé¡¶æœ€é¡¶ç«¯çš„ä¸¤ä¸ªæ•°å€¼äº’æ¢ï¼Œè¿™ä¸ªæ•°å€¼ä¸èƒ½æ˜¯å ç”¨ 2 ä¸ªæ§½ä½çš„ long æˆ– double ç±»å‹ï¼Œé‚£ä¹ˆå¦‚æœéœ€è¦äº’æ¢ä¸¤ä¸ª long æˆ– double ç±»å‹ï¼ŒJVM è™šæ‹Ÿæœºè¯¥å¦‚ä½•æ“ä½œå‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯ä½¿ç”¨ <code>dup2_x2</code> æŒ‡ä»¤ï¼Œå¤åˆ¶æ ˆé¡¶çš„ 2 ä¸ª Slot å¯¹åº”çš„ long æˆ– double ç±»å‹ï¼Œå¹¶æ’å…¥åˆ°æ ˆé¡¶ 4 ä¸ª Slot ä¸‹çš„ä½ç½®ï¼Œå†ä½¿ç”¨ <code>pop2</code> æŒ‡ä»¤å¼¹å‡ºæ ˆé¡¶çš„ long æˆ– double ç±»å‹ï¼Œè¿™æ ·å°±å®Œæˆäº† long æˆ– double ç±»å‹çš„äº¤æ¢ã€‚</p><h3 id="æµç¨‹æ§åˆ¶æŒ‡ä»¤"><a class="markdownIt-Anchor" href="#æµç¨‹æ§åˆ¶æŒ‡ä»¤"></a> æµç¨‹æ§åˆ¶æŒ‡ä»¤</h3><p>æµç¨‹æ§åˆ¶æŒ‡ä»¤ä¸»è¦åŒ…æ‹¬åˆ†æ”¯å’Œå¾ªç¯ç­‰æ“ä½œï¼Œè¿™äº›æŒ‡ä»¤ä¼šé€šè¿‡æ£€æŸ¥æ¡ä»¶æ¥æ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæµç¨‹ï¼Œä¸€èˆ¬åŒ…æ‹¬äº†ï¼š<code>if... then... else...</code>ã€<code>for...</code>ã€<code>try &#123;...&#125; catch (...)</code> ç­‰å¸¸ç”¨è¯­å¥ã€‚ä¸ºäº†æ–¹ä¾¿ä»‹ç»æµç¨‹æ§åˆ¶æŒ‡ä»¤ï¼Œæˆ‘ä»¬ç¼–å†™äº†å¦‚ä¸‹çš„ç®€å•ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">FlowControl</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        Collection&lt;Integer&gt; numbers = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> each : numbers) &#123;</span><br><span class="line">            <span class="keyword">if</span> (each % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(each);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘åæŸ¥çœ‹å­—èŠ‚ç ï¼Œå¯ä»¥å¾—åˆ°çš„å­—èŠ‚ç ä¿¡æ¯ï¼Œ<code>0: iconst_5</code> è¡¨ç¤ºåˆå§‹åŒ–ä¸€ä¸ª <code>int</code> å‹å¸¸é‡ 5ï¼Œå®ƒç”¨äºè¡¨ç¤ºæ•°ç»„çš„é•¿åº¦ã€‚ç´§æ¥ç€ <code>1: anewarray</code> å°±åˆ›å»ºäº†ä¸€ä¸ª Integer ç±»å‹çš„æ•°ç»„ã€‚ç„¶åä¾æ¬¡åˆå§‹åŒ–å¸¸é‡ 1 ~ 5ï¼Œå¹¶ä½¿ç”¨ <code>Integer.valueOf</code> å°†åŸºç¡€ç±»å‹è½¬æ¢ä¸ºåŒ…è£…ç±»å‹ï¼Œç„¶åå­˜å‚¨åˆ°æ•°ç»„çš„ 0 ~ 4 ä½ç½®ä¸­ã€‚æ•°ç»„åˆå§‹åŒ–å®Œæˆåï¼Œä¼šè°ƒç”¨ <code>Arrays.asList</code> æ–¹æ³•è½¬æ¢ä¸º <code>List</code> å¯¹è±¡ï¼Œå†ä½¿ç”¨ <code>astore_1</code> å°†é›†åˆå¯¹è±¡å­˜å‚¨åˆ°æœ¬åœ°å˜é‡è¡¨çš„ç¬¬äºŒä¸ªä½ç½®ä¸­ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">Code:</span><br><span class="line">  stack=<span class="number">4</span>, locals=<span class="number">4</span>, args_size=<span class="number">1</span></span><br><span class="line">     <span class="number">0</span>: iconst_5</span><br><span class="line">     <span class="number">1</span>: anewarray     #<span class="number">2</span>                  <span class="comment">// class java/lang/Integer</span></span><br><span class="line">     <span class="number">4</span>: dup</span><br><span class="line">     <span class="number">5</span>: iconst_0</span><br><span class="line">     <span class="number">6</span>: iconst_1</span><br><span class="line">     <span class="number">7</span>: invokestatic  #<span class="number">3</span>                  <span class="comment">// Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;</span></span><br><span class="line">    <span class="number">10</span>: aastore</span><br><span class="line">    <span class="number">11</span>: dup</span><br><span class="line">    <span class="number">12</span>: iconst_1</span><br><span class="line">    <span class="number">13</span>: iconst_2</span><br><span class="line">    <span class="number">14</span>: invokestatic  #<span class="number">3</span>                  <span class="comment">// Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;</span></span><br><span class="line">    <span class="number">17</span>: aastore</span><br><span class="line">    <span class="number">18</span>: dup</span><br><span class="line">    <span class="number">19</span>: iconst_2</span><br><span class="line">    <span class="number">20</span>: iconst_3</span><br><span class="line">    <span class="number">21</span>: invokestatic  #<span class="number">3</span>                  <span class="comment">// Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;</span></span><br><span class="line">    <span class="number">24</span>: aastore</span><br><span class="line">    <span class="number">25</span>: dup</span><br><span class="line">    <span class="number">26</span>: iconst_3</span><br><span class="line">    <span class="number">27</span>: iconst_4</span><br><span class="line">    <span class="number">28</span>: invokestatic  #<span class="number">3</span>                  <span class="comment">// Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;</span></span><br><span class="line">    <span class="number">31</span>: aastore</span><br><span class="line">    <span class="number">32</span>: dup</span><br><span class="line">    <span class="number">33</span>: iconst_4</span><br><span class="line">    <span class="number">34</span>: iconst_5</span><br><span class="line">    <span class="number">35</span>: invokestatic  #<span class="number">3</span>                  <span class="comment">// Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;</span></span><br><span class="line">    <span class="number">38</span>: aastore</span><br><span class="line">    <span class="number">39</span>: invokestatic  #<span class="number">4</span>                  <span class="comment">// Method java/util/Arrays.asList:([Ljava/lang/Object;)Ljava/util/List;</span></span><br><span class="line">    <span class="number">42</span>: astore_1</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure><p>ä¸‹é¢è¿™éƒ¨åˆ†å­—èŠ‚ç æ‰æ˜¯æµç¨‹æ§åˆ¶çš„å…³é”®ï¼Œå¯ä»¥çœ‹åˆ° <code>for ... each</code> è¯­å¥ç¼–è¯‘ä¹‹åä½¿ç”¨äº†è¿­ä»£å™¨ï¼ˆä¼¼ä¹å¹¶ä¸æ€»æ˜¯ä½¿ç”¨ <code>for index++</code> æ‰§è¡Œï¼‰ï¼Œå¾ªç¯è¿‡ç¨‹ä¸­å…ˆè°ƒç”¨ <code>hasNext</code> æ–¹æ³•åˆ¤æ–­è¿­ä»£å™¨æ˜¯å¦éœ€è¦ç»§ç»­æ‰§è¡Œï¼Œè¯¥è¿”å›ä¼šè¿”å› <code>true</code>ï¼Œ<code>false</code>ï¼ŒJVM è™šæ‹Ÿæœºä¼šå°†å…¶è½¬æ¢ä¸º 1 å’Œ 0 å‹å…¥æ ˆé¡¶ã€‚<code>56: ifeq 91</code> åˆ™ä¼šåˆ¤æ–­æ ˆé¡¶ int æ•°å€¼æ˜¯å¦ç­‰äº 0ï¼Œç›¸ç­‰åˆ™è·³è½¬åˆ°ç¨‹åºè®¡æ•°å™¨ 91 çš„ä½ç½®æ‰§è¡Œã€‚</p><p>å¦‚æœä¸ç­‰äº 0 åˆ™ä»£è¡¨å½“å‰é›†åˆä»ç„¶æœ‰å€¼ï¼Œä¼šé€šè¿‡ <code>60: invokeinterface #7, 1</code> è°ƒç”¨è¿­ä»£å™¨çš„ <code>next</code> æ–¹æ³•ï¼Œç„¶åé€šè¿‡ <code>irem</code> æŒ‡ä»¤ä»æ ˆé¡¶å–å‡º <code>iconst_2</code> å®šä¹‰çš„å¸¸é‡ 2ï¼Œå¹¶è¿›è¡Œå–æ¨¡è¿ç®—ã€‚<code>75: ifne 81</code> ä¼šåˆ¤æ–­æ ˆé¡¶ int ç±»å‹å€¼æ˜¯å¦ä¸ç­‰äº 0ï¼Œä¸ç­‰äºåˆ™è·³è½¬åˆ°ç¨‹åºè®¡æ•°å™¨ 81 çš„ä½ç½®ï¼Œæ‰§è¡Œ <code>println</code> æ“ä½œï¼Œå¦åˆ™æ‰§è¡Œ <code>78: goto 50</code> æŒ‡ä»¤è·³è½¬åˆ°ç¨‹åºè®¡æ•°å™¨ 50 ä½ç½®ï¼Œç»§ç»­æ‰§è¡Œä¸‹ä¸€æ¬¡å¾ªç¯æ“ä½œã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Code:</span><br><span class="line">  stack=<span class="number">4</span>, locals=<span class="number">4</span>, args_size=<span class="number">1</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="number">43</span>: aload_1</span><br><span class="line">    <span class="number">44</span>: invokeinterface #<span class="number">5</span>,  <span class="number">1</span>            <span class="comment">// InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;</span></span><br><span class="line">    <span class="number">49</span>: astore_2</span><br><span class="line">    <span class="number">50</span>: aload_2</span><br><span class="line">    <span class="number">51</span>: invokeinterface #<span class="number">6</span>,  <span class="number">1</span>            <span class="comment">// InterfaceMethod java/util/Iterator.hasNext:()Z</span></span><br><span class="line">    <span class="number">56</span>: ifeq          <span class="number">91</span></span><br><span class="line">    <span class="number">59</span>: aload_2</span><br><span class="line">    <span class="number">60</span>: invokeinterface #<span class="number">7</span>,  <span class="number">1</span>            <span class="comment">// InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;</span></span><br><span class="line">    <span class="number">65</span>: checkcast     #<span class="number">2</span>                  <span class="comment">// class java/lang/Integer</span></span><br><span class="line">    <span class="number">68</span>: invokevirtual #<span class="number">8</span>                  <span class="comment">// Method java/lang/Integer.intValue:()I</span></span><br><span class="line">    <span class="number">71</span>: istore_3</span><br><span class="line">    <span class="number">72</span>: iload_3</span><br><span class="line">    <span class="number">73</span>: iconst_2</span><br><span class="line">    <span class="number">74</span>: irem</span><br><span class="line">    <span class="number">75</span>: ifne          <span class="number">81</span></span><br><span class="line">    <span class="number">78</span>: <span class="keyword">goto</span>          <span class="number">50</span></span><br><span class="line">    <span class="number">81</span>: getstatic     #<span class="number">9</span>                  <span class="comment">// Field java/lang/System.out:Ljava/io/PrintStream;</span></span><br><span class="line">    <span class="number">84</span>: iload_3</span><br><span class="line">    <span class="number">85</span>: invokevirtual #<span class="number">10</span>                 <span class="comment">// Method java/io/PrintStream.println:(I)V</span></span><br><span class="line">    <span class="number">88</span>: <span class="keyword">goto</span>          <span class="number">50</span></span><br><span class="line">    <span class="number">91</span>: <span class="keyword">return</span></span><br></pre></td></tr></table></figure><p>å…³äºæ›´å¤šçš„æµç¨‹æ§åˆ¶æŒ‡ä»¤ï¼Œå¤§å®¶å¯ä»¥è‡ªè¡Œå°è¯•ç¼–å†™ä»£ç åˆ†æï¼Œå­—èŠ‚ç æŒ‡ä»¤å«ä¹‰å¯å‚è€ƒ<a href="https://strongduanmu.com/blog/opcode-mnemonics-by-opcode.html#%E6%AF%94%E8%BE%83-comparisons">æ¯”è¾ƒ Comparisons</a> å’Œ<a href="https://strongduanmu.com/blog/opcode-mnemonics-by-opcode.html#%E6%8E%A7%E5%88%B6-control">æ§åˆ¶ Control</a>ã€‚</p><h3 id="æ–¹æ³•è°ƒç”¨æŒ‡ä»¤"><a class="markdownIt-Anchor" href="#æ–¹æ³•è°ƒç”¨æŒ‡ä»¤"></a> æ–¹æ³•è°ƒç”¨æŒ‡ä»¤</h3><p>å‰æ–‡æˆ‘ä»¬å·²ç»ä»‹ç»äº†éƒ¨åˆ†æ–¹æ³•è°ƒç”¨æŒ‡ä»¤ï¼Œä¾‹å¦‚ï¼šåœ¨æ„é€ æ–¹æ³•åˆå§‹åŒ–æ—¶ï¼Œä¼šè°ƒç”¨ <code>invokespecial</code> è¿›è¡Œåˆå§‹åŒ–ã€‚ä¸‹é¢åˆ—ä¸¾äº†å¸¸ç”¨æ–¹æ³•è°ƒç”¨æŒ‡ä»¤çš„å«ä¹‰ï¼š</p><ul><li><code>invokevirtual</code>ï¼šè°ƒç”¨å®ä¾‹æ–¹æ³•ï¼›</li><li><code>invokespecial</code>ï¼šè°ƒç”¨è¶…ç±»æ„é€ æ–¹æ³•ï¼Œå®ä¾‹åˆå§‹åŒ–æ–¹æ³•ï¼Œç§æœ‰æ–¹æ³•ï¼›</li><li><code>invokestatic</code>ï¼šè°ƒç”¨é™æ€æ–¹æ³•ï¼›</li><li><code>invokeinterface</code>ï¼šè°ƒç”¨æ¥å£æ–¹æ³•ï¼›</li><li><code>invokedynamic</code>ï¼šè°ƒç”¨åŠ¨æ€æ–¹æ³•ã€‚</li></ul><p>ç»†å¿ƒçš„æœ‹å‹å¯èƒ½ä¼šå‘ç°ï¼Œ<code>invokevirtual</code> å’Œ <code>invokeinterface</code> æœ‰äº›ç±»ä¼¼ï¼Œä¸€ä¸ªæ˜¯è°ƒç”¨å®ä¾‹æ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯è°ƒç”¨æ¥å£æ–¹æ³•ã€‚é‚£ä¹ˆä»–ä»¬ä¹‹é—´æœ‰ä»€ä¹ˆå·®å¼‚å‘¢ï¼Ÿæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå°ä¾‹å­æ¥è¯´æ˜ä¸‹ï¼Œä¸‹é¢çš„ç¤ºä¾‹ä¸­æœ‰ A å’Œ B ä¸¤ä¸ªç±»ï¼ŒA ç±»ä¸­å®šä¹‰äº† <code>method1</code> å’Œ <code>method2</code>ï¼ŒB ç±»ç»§æ‰¿äº† A ç±»ï¼Œå¹¶é‡å†™äº† <code>method2</code>ï¼Œç„¶åå¢åŠ äº† <code>method3</code>ã€‚æ­¤å¤–ï¼ŒB ç±»è¿˜å®ç°äº†æ¥å£ Xï¼Œé‡å†™äº† <code>methodX</code>ï¼ŒC ç±»ä¹ŸåŒæ ·å®ç°äº† X æ¥å£ï¼Œå¹¶é‡å†™äº† <code>methodX</code>ã€‚</p><p>åœ¨ JVM ä¸­æ‰§è¡Œæ–¹æ³•æ—¶ï¼Œéœ€è¦å…ˆè§£æè¯¥æ–¹æ³•ã€‚åœ¨ç±»çš„å®šä¹‰ä¸­æœ‰ä¸€ä¸ªæ–¹æ³•è¡¨ï¼Œæ‰€æœ‰æ–¹æ³•éƒ½å¯¹åº”äº†ä¸€ä¸ªç¼–å·ï¼ŒJVM è§£æè¿‡ç¨‹ä¸­ä¼šä»æ–¹æ³•è¡¨ä¸­æŸ¥æ‰¾æ–¹æ³•å¯¹åº”çš„ç¼–å·ä½ç½®ã€‚è¿™ä¸ªæ¡ˆä¾‹ä¸­ï¼Œå¦‚æœæˆ‘ä»¬è°ƒç”¨ B ç±»çš„ <code>method2</code> æ–¹æ³•ï¼Œç”±äºè¯¥æ–¹æ³•åœ¨ B ç±»ä¸­è¿›è¡Œäº†é‡å†™ï¼Œå› æ­¤å¯ä»¥ç›´æ¥åœ¨ B ç±»çš„æ–¹æ³•è¡¨ä¸­å¿«é€ŸæŸ¥æ‰¾åˆ°ï¼Œå› æ­¤ä½¿ç”¨ <code>invokevirtual B#method2</code> æŒ‡ä»¤å³å¯ã€‚å¦‚æœæˆ‘ä»¬è°ƒç”¨ B ç±»çš„ <code>method1</code> æ–¹æ³•ï¼Œç”±äºè¯¥æ–¹æ³• B ç±»æ²¡æœ‰é‡å†™ï¼Œç»§æ‰¿çš„æ˜¯çˆ¶ç±»çš„æ–¹æ³•ï¼Œå› æ­¤ä½¿ç”¨ <code>invokevirtual B#method1</code> æŒ‡ä»¤æ—¶ï¼Œä¼šé€šè¿‡æŒ‡é’ˆæ‰¾åˆ° <code>A#method1</code> æ–¹æ³•ã€‚</p><p>æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ X æ¥å£è°ƒç”¨ <code>methodX</code> æ–¹æ³•ï¼Œæ­¤æ—¶ä¼šç”Ÿæˆ <code>invokeinterface</code> æŒ‡ä»¤è¿›è¡Œè°ƒç”¨ï¼Œç”±äºä¸åŒå¯¹è±¡ <code>methodX</code> æ–¹æ³•çš„ç¼–å·ä½ç½®ä¸åŒï¼Œåœ¨æ‰§è¡Œ <code>invokeinterface</code> æŒ‡ä»¤æ—¶ï¼Œå°±éœ€è¦åœ¨è¿è¡Œæ—¶åŠ¨æ€åœ°æŸ¥æ‰¾ä¸åŒç±»ä¸­çš„ä½ç½®ï¼Œæ•ˆç‡ä¼šæœ‰äº›å½±å“ã€‚å½“ç„¶ï¼Œå°½ç®¡æ¥å£è°ƒç”¨ä¼šæœ‰ä¸€äº›é¢å¤–å¼€é”€ï¼Œä½†ä¹Ÿæ— éœ€ä¸ºäº†è¿™ç‚¹å°çš„ä¼˜åŒ–è€Œä¸å»ä½¿ç”¨æ¥å£ï¼Œå› ä¸º JVM ä¸­çš„ JIT ç¼–è¯‘å™¨ä¼šå¸®æˆ‘ä»¬ä¼˜åŒ–è¿™éƒ¨åˆ†çš„æ€§èƒ½æŸè€—ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span></span><br><span class="line">	method1</span><br><span class="line">	method2</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span> <span class="keyword">extends</span> <span class="title class_">A</span> implement X</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	method2</span><br><span class="line">	method3</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	methodX</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">C</span> <span class="keyword">implements</span> <span class="title class_">X</span></span><br><span class="line">	methodC</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	methodX</span><br></pre></td></tr></table></figure><p>é™¤äº† <code>invokevirtual</code> å’Œ <code>invokeinterface</code> å¤–ï¼Œ<code>invokedynamic</code> æŒ‡ä»¤ä¹Ÿå€¼å¾—æ‹¿å‡ºæ¥è¯´ä¸€è¯´ã€‚ä» JDK 7 å¼€å§‹ï¼ŒJVM æ–°å¢äº† <code>invokedynamic</code> æŒ‡ä»¤ï¼Œè¿™æ¡æŒ‡ä»¤æ˜¯ä¸ºäº†å®ç°<code>åŠ¨æ€ç±»å‹è¯­è¨€ï¼ˆDynamically Typed Languageï¼‰</code> è€Œè¿›è¡Œåœ°æ”¹è¿›ä¹‹ä¸€ï¼Œä¹Ÿæ˜¯ JDK 8 æ”¯æŒ Lambda è¡¨è¾¾å¼çš„åŸºç¡€ã€‚</p><p>æˆ‘ä»¬çŸ¥é“åœ¨ä¸æ”¹å˜å­—èŠ‚ç çš„æƒ…å†µä¸‹ï¼Œæƒ³è¦å®ç°è°ƒç”¨ Demo ç±»çš„ test æ–¹æ³•ï¼Œåªæœ‰ä¸¤ç§åŠæ³•ï¼š</p><ol><li>ä½¿ç”¨ <code>new Demo().test();</code>ï¼Œå…ˆåˆ›å»º Demo ç±»ï¼Œç„¶åé€šè¿‡å¯¹è±¡è°ƒç”¨ test æ–¹æ³•ï¼›</li><li>ä½¿ç”¨åå°„ APIï¼Œé€šè¿‡ <code>Demo.class.getMethod</code> è·å–åˆ° Method å¯¹è±¡ï¼Œç„¶åè°ƒç”¨ <code>Method.invoke</code> åå°„è°ƒç”¨ test æ–¹æ³•ã€‚</li></ol><p>è¿™ä¸¤ä¸ªæ–¹æ³•éƒ½éœ€è¦æ˜¾å¼åœ°æŠŠæ–¹æ³• test å’Œç±»å‹ Demo å…³è”èµ·æ¥ï¼Œå‡è®¾æˆ‘ä»¬è¿˜æœ‰ä¸€ä¸ªç±»å‹ Demo2ï¼Œå®ƒä¹Ÿæœ‰ä¸€ä¸ªä¸€æ¨¡ä¸€æ ·çš„æ–¹æ³• testï¼Œè¿™æ—¶å€™æˆ‘ä»¬åˆè¦å¦‚ä½•è°ƒç”¨ test æ–¹æ³•å‘¢ï¼Ÿåœ¨ JDK 8 ä¹‹å‰ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šå®šä¹‰ä¸€ä¸ªå…¬å…±æ¥å£ï¼Œç„¶åå°† test æ–¹æ³•å£°æ˜åœ¨æ¥å£ä¸­ï¼Œå¹¶è®© Demo å’Œ Demo2 å®ç°è¿™ä¸ªæ¥å£ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é¢å‘æ¥å£è¿›è¡Œè°ƒç”¨ã€‚</p><p>è™½ç„¶é¢å‘æ¥å£å¯ä»¥å®ç°ï¼Œä½†æ˜¯æ€»ä½“ä¸Šä½“éªŒå¾ˆå·®ï¼Œå¢åŠ äº†å¾ˆå¤šé¢å¤–çš„å·¥ä½œï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒJDK 8 å®ç°äº†å…¨æ–°çš„ Lambda è¡¨è¾¾å¼ã€‚Lambda è¡¨è¾¾å¼çš„æœ¬è´¨æ˜¯å¯¹è±¡å¼•ç”¨ï¼Œå®ƒåŸºäº <code>invokedynamic</code> æŒ‡ä»¤ï¼Œé…åˆæ–°å¢çš„æ–¹æ³•å¥æŸ„ <code>Method Hanlders</code>ï¼ˆå®ƒå¯ä»¥ç”¨æ¥æè¿°ä¸€ä¸ªè·Ÿç±»å‹ Demo æ— å…³çš„ test æ–¹æ³•ç­¾åï¼Œç”šè‡³ä¸åŒ…æ‹¬æ–¹æ³•åç§°ï¼Œè¿™æ ·å°±å¯ä»¥åšåˆ°ä¸åŒçš„å¯¹è±¡è°ƒç”¨åŒä¸€ä¸ªç­¾åçš„æ–¹æ³•ï¼‰ï¼Œå¯ä»¥åœ¨è¿è¡Œæ—¶å†å†³å®šç”±å“ªä¸ªç±»æ¥æ¥æ”¶è¢«è°ƒç”¨çš„æ–¹æ³•ã€‚å…³äº invokedynamic æŒ‡ä»¤çš„æ›´å¤šç»†èŠ‚ï¼Œå¯ä»¥å‚è€ƒ <a target="_blank" rel="noopener" href="https://it.deepinmind.com/jvm/2019/07/19/jvm-method-invocation-invokedynamic.html">JVM ä¹‹åŠ¨æ€æ–¹æ³•è°ƒç”¨ï¼šinvokedynamic</a> è¿›è¡Œå­¦ä¹ äº†è§£ã€‚</p><h3 id="ç®—æœ¯è¿ç®—åŠç±»å‹è½¬æ¢æŒ‡ä»¤"><a class="markdownIt-Anchor" href="#ç®—æœ¯è¿ç®—åŠç±»å‹è½¬æ¢æŒ‡ä»¤"></a> ç®—æœ¯è¿ç®—åŠç±»å‹è½¬æ¢æŒ‡ä»¤</h3><p>JVM æŒ‡ä»¤ä¸­è¿˜åŒ…å«äº†å¾ˆå¤šç®—æœ¯è¿ç®—æŒ‡ä»¤ï¼Œå¯¹äºæ‰€æœ‰çš„æ•°å€¼ç±»å‹ <code>int</code>ï¼ˆ<code>boolean</code>ã€<code>byte</code>ã€<code>char</code> å’Œ <code>short</code> éƒ½ä¼šè¢«å½“åš <code>int</code> è¿ç®—ï¼‰ã€<code>long</code>ã€<code>float</code> å’Œ <code>double</code> éƒ½æœ‰åŠ ã€å‡ã€ä¹˜ã€é™¤ã€å–æ¨¡å’Œå–åæŒ‡ä»¤ï¼Œä¸‹è¡¨å±•ç¤ºäº†ä¸åŒæ•°å€¼ç±»å‹å¯¹åº”çš„è¿ç®—æŒ‡ä»¤ã€‚</p><table><thead><tr><th>ç±»å‹/è¿ç®—</th><th>add(+)</th><th>subtract(-)</th><th>multiply(*)</th><th>divide(/)</th><th>remainder(%)</th><th>negate(-)</th></tr></thead><tbody><tr><td>int</td><td>iadd</td><td>isub</td><td>imul</td><td>idiv</td><td>irem</td><td>ineg</td></tr><tr><td>long</td><td>ladd</td><td>lsub</td><td>lmul</td><td>ldiv</td><td>lrem</td><td>lneg</td></tr><tr><td>float</td><td>fadd</td><td>fsub</td><td>fmul</td><td>fdiv</td><td>frem</td><td>fneg</td></tr><tr><td>double</td><td>dadd</td><td>dsub</td><td>dmul</td><td>ddiv</td><td>drem</td><td>dneg</td></tr></tbody></table><p>å½“æˆ‘ä»¬å°†æŸä¸€ç§ç±»å‹çš„å€¼èµ‹å€¼ç»™å¦å¤–ä¸€ç§ç±»å‹ï¼Œæˆ–è€…ä¸åŒçš„ç±»å‹æ··åˆè¿ç®—æ—¶ï¼Œè¿™æ—¶å€™å°±ä¼šå‘ç”Ÿç±»å‹è½¬æ¢ï¼Œé€šå¸¸éšå¼ç±»å‹è½¬æ¢éƒ½æ˜¯ç”±ä½ç²¾åº¦å‘é«˜ç²¾åº¦è½¬æ¢ï¼Œä¾‹å¦‚ï¼š<code>int</code> è½¬æ¢ä¸º <code>long</code>ï¼Œ<code>float</code> è½¬æ¢ä¸º <code>double</code>ï¼Œè€Œé«˜ç²¾åº¦å‘ä½ç²¾åº¦è½¬æ¢åˆ™éœ€è¦æ˜¾å¼ç±»å‹è½¬æ¢ï¼Œä¾‹å¦‚ï¼š<code>(int) 1000L</code>ã€‚</p><table><thead><tr><th>From/To</th><th>int</th><th>long</th><th>float</th><th>double</th><th>byte</th><th>char</th><th>short</th></tr></thead><tbody><tr><td>int</td><td>-</td><td>i2l</td><td>i2f</td><td>i2d</td><td>i2b</td><td>i2c</td><td>i2s</td></tr><tr><td>long</td><td>l2i</td><td>-</td><td>l2f</td><td>l2d</td><td>-</td><td>-</td><td>-</td></tr><tr><td>float</td><td>f2i</td><td>f2l</td><td>-</td><td>f2d</td><td>-</td><td>-</td><td>-</td></tr><tr><td>double</td><td>d2i</td><td>d2l</td><td>d2f</td><td>-</td><td>-</td><td>-</td><td>-</td></tr></tbody></table><p>ä¸Šè¡¨å±•ç¤ºäº†å¸¸è§çš„æ•°å€¼ç±»å‹è½¬æ¢æŒ‡ä»¤ï¼Œå¯ä»¥å‘ç° <code>int</code>ã€<code>long</code>ã€<code>float</code> å’Œ <code>double</code> ç±»å‹ä¹‹é—´éƒ½æœ‰ç›¸äº’è½¬æ¢çš„æŒ‡ä»¤ï¼Œè€Œ <code>long</code>ã€<code>float</code> å’Œ <code>double</code> å´æ²¡æœ‰è½¬æ¢çš„æŒ‡ä»¤ã€‚æˆ‘ä»¬ç¼–å†™å¦‚ä¸‹ç®€å•çš„è½¬æ¢é€»è¾‘ï¼Œå°† <code>b</code> å˜é‡è°ƒæ•´ä¸º <code>float</code> ç±»å‹ï¼Œç”±äºéšå¼ç±»å‹è½¬æ¢ä¼šæœ‰ä½ç²¾åº¦å‘é«˜ç²¾åº¦è½¬æ¢ï¼Œå› æ­¤ <code>((a + b) * c)</code> çš„ç»“æœä¸º <code>float</code> ç±»å‹ï¼Œç„¶åæˆ‘ä»¬å†ç”¨ <code>(byte)</code> å¼ºåˆ¶è¿›è¡Œç±»å‹è½¬æ¢ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="type">int</span> <span class="title function_">calculate</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> <span class="number">100</span>;</span><br><span class="line">    <span class="type">float</span> <span class="variable">b</span> <span class="operator">=</span> <span class="number">200</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">c</span> <span class="operator">=</span> <span class="number">300</span>;</span><br><span class="line">    <span class="keyword">return</span> (<span class="type">byte</span>) ((a + b) * c);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ç¼–è¯‘è¿™æ®µä»£ç å¹¶ä½¿ç”¨ <code>javap</code> æŸ¥çœ‹å­—èŠ‚ç ï¼Œå‘ç° JVM ä¼šå…ˆä½¿ç”¨ <code>f2i</code> å°† float ç±»å‹çš„ç»“æœè½¬æ¢ä¸º int ç±»å‹ï¼Œç„¶åå†ä½¿ç”¨ <code>i2b</code> å°† int ç±»å‹è½¬æ¢ä¸º byte ç±»å‹ï¼Œå®é™…ä¸Šç”¨äº†ä¸¤ä¸ªæŒ‡ä»¤å®ç°äº† <code>float</code> åˆ° <code>byte</code> çš„è½¬æ¢ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Code:</span><br><span class="line">  stack=<span class="number">2</span>, locals=<span class="number">4</span>, args_size=<span class="number">1</span></span><br><span class="line">     <span class="number">0</span>: bipush        <span class="number">100</span></span><br><span class="line">     <span class="number">2</span>: istore_1</span><br><span class="line">     <span class="number">3</span>: ldc           #<span class="number">7</span>                  <span class="comment">// float 200.0f</span></span><br><span class="line">     <span class="number">5</span>: fstore_2</span><br><span class="line">     <span class="number">6</span>: sipush        <span class="number">300</span></span><br><span class="line">     <span class="number">9</span>: istore_3</span><br><span class="line">    <span class="number">10</span>: iload_1</span><br><span class="line">    <span class="number">11</span>: i2f</span><br><span class="line">    <span class="number">12</span>: fload_2</span><br><span class="line">    <span class="number">13</span>: fadd</span><br><span class="line">    <span class="number">14</span>: iload_3</span><br><span class="line">    <span class="number">15</span>: i2f</span><br><span class="line">    <span class="number">16</span>: fmul</span><br><span class="line">    <span class="number">17</span>: f2i</span><br><span class="line">    <span class="number">18</span>: i2b</span><br><span class="line">    <span class="number">19</span>: ireturn</span><br></pre></td></tr></table></figure><h2 id="ç»“è¯­"><a class="markdownIt-Anchor" href="#ç»“è¯­"></a> ç»“è¯­</h2><p>æœ¬æ–‡ä»å­—èŠ‚ç çš„åŸºç¡€æ¦‚å¿µå¼€å§‹ï¼Œä¸ºå¤§å®¶ä»‹ç»äº† <code>javap</code> å’Œ <code>jclasslib</code> ä¸¤ç§æŸ¥çœ‹å­—èŠ‚ç çš„æ–¹å¼ï¼Œé€šè¿‡å·¥å…·æˆ‘ä»¬èƒ½è·Ÿè§‚å¯Ÿåˆ°å­—èŠ‚ç ä¸­çš„å…³é”®ä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼š<strong>Classfileã€Class åŸºç¡€ä¿¡æ¯ã€å¸¸é‡æ± ã€å­—èŠ‚ç å’Œ SourceFile</strong>ï¼Œå…¶ä¸­<strong>æœ€é‡è¦çš„å¸¸é‡æ± å’Œå­—èŠ‚ç </strong>æœ¬æ–‡ä¹Ÿè¿›è¡Œäº†æ·±å…¥æ¢ç©¶ã€‚</p><p>ç„¶åæˆ‘ä»¬åˆç»“åˆä¸€ä¸ªç¤ºä¾‹è®¡ç®—é€»è¾‘ï¼Œé€ä¸ªå­—èŠ‚ç ä¸ºå¤§å®¶ä»‹ç»å­—èŠ‚ç çš„æ‰§è¡Œè¿‡ç¨‹ï¼Œç›¸ä¿¡å¤§å®¶ä¸€å®šå¯¹ç¨‹åºè®¡æ•°å™¨ã€å±€éƒ¨å˜é‡è¡¨ä»¥åŠæ“ä½œæ ˆä¹‹é—´çš„å…³ç³»æœ‰äº†æ·±åˆ»çš„ç†è§£ã€‚</p><p>åœ¨æœ€åä¸€ä¸ªéƒ¨åˆ†ï¼Œæˆ‘ä»¬å¯¹å¸¸ç”¨çš„å­—èŠ‚ç æŒ‡ä»¤è¿›è¡Œäº†ä»‹ç»ï¼ŒæœŸæœ›èƒ½å¤Ÿå¸®åŠ©å¤§å®¶äº†è§£å¸¸ç”¨å­—èŠ‚ç çš„ä½œç”¨ï¼Œå¹¶èƒ½è·Ÿåœ¨å®é™…çš„é¡¹ç›®ä¸­ç†è§£è¿™äº›å­—èŠ‚ç ï¼Œè¿›è€Œå¸®åŠ©æˆ‘ä»¬æ’æŸ¥é—®é¢˜ã€‚</p><p>ç”±äº JVM è™šæ‹Ÿæœºè§„èŒƒä¸­æ€»å…±å®šä¹‰äº† 200 å¤šä¸ªå­—èŠ‚ç ï¼Œè€ƒè™‘åˆ°æ–‡ç« çš„ç¯‡å¹…ï¼Œæˆ‘ä»¬æ— æ³•ä¸€ä¸€è¿›è¡Œä»‹ç»ï¼Œæ„Ÿå…´è¶£çš„è¯»è€…å¯ä»¥å‚è€ƒ <a href="https://strongduanmu.com/blog/opcode-mnemonics-by-opcode.html">Java è™šæ‹ŸæœºæŒ‡ä»¤æ“ä½œç å’ŒåŠ©è®°ç¬¦æ˜ å°„å…³ç³»</a>ï¼Œæ¢ç©¶å­¦ä¹ å…¶ä»–å­—èŠ‚ç æŒ‡ä»¤ã€‚</p><div class="tag-plugin quot"><p class="content" type="text"><span class="empty"></span><span class="text">æ¬¢è¿å…³æ³¨</span><span class="empty"></span></p></div><p>æ¬¢è¿å…³æ³¨ã€Œ<strong>ç«¯å°å¼ºçš„åšå®¢</strong>ã€å¾®ä¿¡å…¬ä¼—å·ï¼Œä¼šä¸å®šæœŸåˆ†äº«æ—¥å¸¸å­¦ä¹ å’Œå·¥ä½œç»éªŒï¼Œæ¬¢è¿å¤§å®¶å…³æ³¨äº¤æµã€‚</p><p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/assets/wechat/gongzhonghao.png" alt="å¾®ä¿¡å…¬ä¼—å·"></p><div class="article-footer fs14"><section id="references"><div class="header"><span>å‚è€ƒèµ„æ–™</span></div><div class="body"><ul><li class="post-title"><p><a href="https://strongduanmu.com/blog/opcode-mnemonics-by-opcode.html">Java è™šæ‹ŸæœºæŒ‡ä»¤æ“ä½œç å’ŒåŠ©è®°ç¬¦æ˜ å°„å…³ç³»</a></p></li><li class="post-title"><p><a href="https://strongduanmu.com/share/jvm/JVM%20%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%A7%84%E8%8C%83%EF%BC%88SE7%EF%BC%89%E4%B8%AD%E6%96%87%E7%89%88.pdf">JVM è™šæ‹Ÿæœºè§„èŒƒï¼ˆSE7ï¼‰ä¸­æ–‡ç‰ˆ</a></p></li><li class="post-title"><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/ruoli-0/p/13781170.html">Java JVM ä¹‹ç¨‹åºè®¡æ•°å™¨</a></p></li><li class="post-title"><p><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=rPyqB1l4gko">JVM Bytecode for Dummies (and the Rest of Us Too)</a></p></li><li class="post-title"><p><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000039911004">æˆ‘æ‰€çŸ¥é“ JVM è™šæ‹Ÿæœºä¹‹å­—èŠ‚ç æŒ‡ä»¤é›†ä¸è§£æå…­ï¼ˆæ“ä½œæ•°æ ˆç®¡ç†æŒ‡ä»¤ï¼‰</a></p></li><li class="post-title"><p><a target="_blank" rel="noopener" href="https://www.jrebel.com/blog/java-bytecode-tutorial">Advanced Java Bytecode Tutorial</a></p></li><li class="post-title"><p><a target="_blank" rel="noopener" href="https://it.deepinmind.com/jvm/2019/07/19/jvm-method-invocation.html">JVM ä¸­æ–¹æ³•è°ƒç”¨çš„å®ç°æœºåˆ¶</a></p></li><li class="post-title"><p><a target="_blank" rel="noopener" href="https://it.deepinmind.com/jvm/2019/07/19/jvm-method-invocation-invokedynamic.html">JVM ä¹‹åŠ¨æ€æ–¹æ³•è°ƒç”¨ï¼šinvokedynamic</a></p></li></ul></div></section><section id="license"><div class="header"><span>è®¸å¯åè®®</span></div><div class="body"><p>æœ¬æ–‡é‡‡ç”¨ <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh">ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç¦æ­¢æ¼”ç» 4.0 å›½é™…</a> è®¸å¯åè®®ï¼Œæœªç»æˆæƒè¯·å‹¿è½¬è½½ã€‚</p></div></section><section id="share"><div class="header"><span>åˆ†äº«æ–‡ç« </span></div><div class="body"><div class="link"><input class="copy-area" readonly id="copy-link" value="https://strongduanmu.com/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology.html"></div><div class="social-wrap dis-select"><a class="social share-item wechat" onclick="util.toggle(&quot;qrcode-wechat&quot;)"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/social/b32ef3da1162a.svg"></a><a class="social share-item weibo" target="_blank" rel="external nofollow noopener noreferrer" href="https://service.weibo.com/share/share.php?url=https://strongduanmu.com/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology.html&title=æ— å…³æ€§çš„åŸºçŸ³ä¹‹ Java å­—èŠ‚ç æŠ€æœ¯åˆæ¢ - ç«¯å°å¼ºçš„åšå®¢&pics=/assets/cover/jvm.png&summary= å‰è¨€
ç†Ÿæ‚‰ Java è¯­è¨€çš„æœ‹å‹åº”è¯¥éƒ½å¬è¿‡ Write Once, Run Anywhere. è¿™æ ·çš„å£å·ï¼Œå®ƒä¸»è¦é˜è¿°åœ°æ˜¯ Java è¯­è¨€çš„è·¨å¹³å°ç‰¹æ€§ã€‚å·¥ç¨‹å¸ˆåªéœ€è¦ç¼–å†™ä¸€æ¬¡ Java æºç ï¼Œå†é€šè¿‡ Java ç¼–è¯‘å™¨å°†æºç ç¼–è¯‘ä¸ºå­—èŠ‚ç ..."><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/social/80c07e4dbb303.svg"></a><a class="social share-item email" href="mailto:?subject=æ— å…³æ€§çš„åŸºçŸ³ä¹‹ Java å­—èŠ‚ç æŠ€æœ¯åˆæ¢ - ç«¯å°å¼ºçš„åšå®¢&amp;body=https://strongduanmu.com/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology.html"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/social/a1b00e20f425d.svg"></a><a class="social share-item link" onclick="util.copy(&quot;copy-link&quot;, &quot;å¤åˆ¶æˆåŠŸ&quot;)"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/social/8411ed322ced6.svg"></a></div><div class="qrcode" id="qrcode-wechat" style="opacity:0;height:0"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://api.qrserver.com/v1/create-qr-code/?size=256x256&data=https://strongduanmu.com/blog/cornerstone-of-irrelevance-preliminary-study-of-java-bytecode-technology.html"></div></div></section></div></article><div class="related-wrap" id="read-next"><section class="body"><div class="item" id="prev"><div class="note">è¾ƒæ–°æ–‡ç« </div><a href="/blog/java-aot-compiler-framework-graalvm-quick-start.html">Java AOT ç¼–è¯‘æ¡†æ¶ GraalVM å¿«é€Ÿå…¥é—¨</a></div><div class="item" id="next"><div class="note">è¾ƒæ—©æ–‡ç« </div><a href="/blog/improving-the-performance-of-an-antlr-parser.html">ANTLR è§£ææ€§èƒ½ä¼˜åŒ–æŒ‡å—</a></div></section></div><div class="related-wrap md-text" id="comments"><section class="header cmt-title cap theme"><p>å¿«æ¥å‚ä¸è®¨è®ºå§~</p></section><section class="body cmt-body giscus"><svg class="loading" style="vertical-align:middle;fill:currentColor;overflow:hidden" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2709"><path d="M832 512c0-176-144-320-320-320V128c211.2 0 384 172.8 384 384h-64zM192 512c0 176 144 320 320 320v64C300.8 896 128 723.2 128 512h64z" p-id="2710"></path></svg><div id="giscus" src="https://giscus.app/client.js" data-repo="strongduanmu/blog" data-repo-id="MDEwOlJlcG9zaXRvcnkzNzQwMDk3Njg=" data-category="Announcements" data-category-id="DIC_kwDOFkrvqM4CZIsa" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme" data-lang="zh-CN" data-loading="lazy" crossorigin="anonymous"></div></section></div><footer class="page-footer footnote"><hr><div class="sitemap"><div class="sitemap-group"><span class="fs15">åšå®¢</span><a href="/categories/">åˆ†ç±»</a><a href="/tags/">æ ‡ç­¾</a><a href="/archives/">å½’æ¡£</a></div><div class="sitemap-group"><span class="fs15">æ–‡æ¡£</span><a href="/wiki/calcite/background.html">Calcite</a><a href="/wiki/cmu_15_445/index.html">CMU 15-445</a><a href="/wiki/cmu_15_721/index.html">CMU 15-721</a></div><div class="sitemap-group"><span class="fs15">ä¾¿ç¬º</span><a href="/notes/">Common</a><a href="/notes/docker.html">Docker</a><a href="/notes/git.html">Git</a></div><div class="sitemap-group"><span class="fs15">æ›´å¤š</span><a href="/more/">å…³äº</a><a href="/more/news/">åŠ¨æ€</a></div></div><div class="text"><p>æœ¬ç«™ç”± <a target="_blank" rel="noopener" href="https://github.com/strongduanmu">@strongduanmu</a> ä½¿ç”¨ <a target="_blank" rel="noopener" href="https://github.com/xaoxuu/hexo-theme-stellar">Stellar</a> ä¸»é¢˜åˆ›å»ºï¼Œä½¿ç”¨ <a target="_blank" rel="noopener" href="https://vercel.com/">Vercel</a> ç½‘ç«™éƒ¨ç½²ã€‚<br>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚<br>æœ¬ç«™æ€»è®¿é—®é‡ <span id="vercount_value_site_pv"></span> æ¬¡ï¼Œæœ¬ç«™è®¿å®¢æ•° <span id="vercount_value_site_uv"></span> äººæ¬¡ã€‚</p></div></footer><div class="main-mask" onclick="sidebar.dismiss()"></div></div><aside class="l_right"><div class="widgets"><widget class="widget-wrapper tagcloud"><div class="widget-header dis-select"><span class="name">æ ‡ç­¾äº‘</span></div><div class="widget-body fs14"><a href="/tags/Antlr/" style="font-size:13.33px;color:#4fbbeb" class="tag -2">Antlr</a> <a href="/tags/Calcite/" style="font-size:20px;color:#6f86d6" class="tag -10">Calcite</a> <a href="/tags/CentOS/" style="font-size:12px;color:#48c6ef" class="tag -0">CentOS</a> <a href="/tags/Charles/" style="font-size:12px;color:#48c6ef" class="tag -0">Charles</a> <a href="/tags/Distributed-Transaction/" style="font-size:12px;color:#48c6ef" class="tag -0">Distributed Transaction</a> <a href="/tags/Docker/" style="font-size:12px;color:#48c6ef" class="tag -0">Docker</a> <a href="/tags/FFmpeg/" style="font-size:12px;color:#48c6ef" class="tag -0">FFmpeg</a> <a href="/tags/GraalVM/" style="font-size:13.33px;color:#4fbbeb" class="tag -2">GraalVM</a> <a href="/tags/In-Action/" style="font-size:13.33px;color:#4fbbeb" class="tag -2">In Action</a> <a href="/tags/JVM/" style="font-size:17.33px;color:#629bde" class="tag -7">JVM</a> <a href="/tags/Java/" style="font-size:13.33px;color:#4fbbeb" class="tag -2">Java</a> <a href="/tags/Java8/" style="font-size:12px;color:#48c6ef" class="tag -0">Java8</a> <a href="/tags/JavaCC/" style="font-size:12px;color:#48c6ef" class="tag -0">JavaCC</a> <a href="/tags/Kernel/" style="font-size:14.67px;color:#55b1e7" class="tag -3">Kernel</a> <a href="/tags/Linux/" style="font-size:12px;color:#48c6ef" class="tag -0">Linux</a> <a href="/tags/MySQL/" style="font-size:16px;color:#5ca6e3" class="tag -5">MySQL</a> <a href="/tags/Paper/" style="font-size:12px;color:#48c6ef" class="tag -0">Paper</a> <a href="/tags/PolarDB-X/" style="font-size:12px;color:#48c6ef" class="tag -0">PolarDB-X</a> <a href="/tags/Query-Optimization/" style="font-size:13.33px;color:#4fbbeb" class="tag -2">Query Optimization</a> <a href="/tags/Remote-Debugging/" style="font-size:13.33px;color:#4fbbeb" class="tag -2">Remote Debugging</a> <a href="/tags/SQLLine/" style="font-size:12px;color:#48c6ef" class="tag -0">SQLLine</a> <a href="/tags/SQLancer/" style="font-size:12px;color:#48c6ef" class="tag -0">SQLancer</a> <a href="/tags/ShardingSphere/" style="font-size:18.67px;color:#6991da" class="tag -8">ShardingSphere</a> <a href="/tags/Transaction/" style="font-size:12px;color:#48c6ef" class="tag -0">Transaction</a> <a href="/tags/VirtualBox/" style="font-size:12px;color:#48c6ef" class="tag -0">VirtualBox</a> <a href="/tags/Wireshark/" style="font-size:12px;color:#48c6ef" class="tag -0">Wireshark</a></div></widget><widget class="widget-wrapper markdown"><div class="widget-header dis-select"><span class="name">èµåŠ©å•†</span></div><div class="widget-body fs14"><p><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9880881761323734" data-ad-slot="1987141063" data-ad-format="auto" data-full-width-responsive="true"></ins></p><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></widget></div></aside><div class="float-panel blur"><button type="button" style="display:none" class="laptop-only rightbar-toggle mobile" onclick="sidebar.rightbar()"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6h11m-11 6h11m-11 6h11M4 6h1v4m-1 0h2m0 8H4c0-1 2-2 2-3s-1-1.5-2-1"/></svg></button> <button type="button" style="display:none" class="mobile-only leftbar-toggle mobile" onclick="sidebar.leftbar()"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="1.5"><path d="M2 11c0-3.771 0-5.657 1.172-6.828C4.343 3 6.229 3 10 3h4c3.771 0 5.657 0 6.828 1.172C22 5.343 22 7.229 22 11v2c0 3.771 0 5.657-1.172 6.828C19.657 21 17.771 21 14 21h-4c-3.771 0-5.657 0-6.828-1.172C2 18.657 2 16.771 2 13z"/><path id="sep" stroke-linecap="round" d="M5.5 10h6m-5 4h4m4.5 7V3"/></g></svg></button></div></div><div class="scripts"><script>let ctx={date_suffix:{just:"åˆšåˆš",min:"åˆ†é’Ÿå‰",hour:"å°æ—¶å‰",day:"å¤©å‰"},root:"/",tag_plugins:{chat:Object.assign({api:"https://siteinfo.listentothewind.cn/api/v1"})},search:{}};if((ctx.search.service="local_search")==ctx.search.service){let e=Object.assign({},'{"field":"all","path":"/search.json","content":true,"skip_search":null,"codeblock":true,"sort":"-date"}');ctx.search[ctx.search.service]=e}let def={avatar:"/assets/placeholder/avatar.svg",cover:"/assets/placeholder/cover.svg"},deps={jquery:"https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js",marked:"https://cdn.jsdelivr.net/npm/marked@13.0.1/lib/marked.umd.min.js"}</script><script>function RunItem(){function n(e,t){this.name=t||e.name,this.run=()=>{try{e()}catch(e){console.log(e)}}}this.list=[],this.start=()=>{for(var e=0;e<this.list.length;e++)this.list[e].run()},this.push=(e,t,r=!0)=>{let s=e,i=new n(s=r?()=>{utils.requestAnimationFrame(e)}:s,t);this.list.push(i)},this.remove=t=>{for(let e=0;e<this.list.length;e++)this.list[e].name==t&&this.list.splice(e,1)}}let utils={css:(e,t,r,s)=>{var i,n,a=window.document,o=a.createElement("link"),d=(n=t||(i=(a.body||a.getElementsByTagName("head")[0]).childNodes)[i.length-1],a.styleSheets);if(s)for(var l in s)s.hasOwnProperty(l)&&o.setAttribute(l,s[l]);o.rel="stylesheet",o.href=e,o.media="only x",function e(t){if(a.body)return t();setTimeout(function(){e(t)})}(function(){n.parentNode.insertBefore(o,t?n:n.nextSibling)});function u(e){for(var t=o.href,r=d.length;r--;)if(d[r].href===t)return e();setTimeout(function(){u(e)})}function h(){o.addEventListener&&o.removeEventListener("load",h),o.media=r||"all"}return o.addEventListener&&o.addEventListener("load",h),o.onloadcssdefined=u,u(h),o},js:(i,n)=>new Promise((t,e)=>{var r=document.createElement("script");if(i.startsWith("/")&&(i=ctx.root+i.substring(1)),r.src=i,n)for(var s of Object.keys(n))r[s]=n[s];else r.async=!0;r.onerror=e,r.onload=r.onreadystatechange=function(){var e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(r.onload=r.onreadystatechange=null,t())},document.head.appendChild(r)}),jq:e=>{"undefined"==typeof jQuery?utils.js(deps.jquery).then(e):e()},onLoading:e=>{e&&$(e).append('<div class="loading-wrap"><svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2"><path stroke-dasharray="60" stroke-dashoffset="60" stroke-opacity=".3" d="M12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3Z"><animate fill="freeze" attributeName="stroke-dashoffset" dur="1.3s" values="60;0"/></path><path stroke-dasharray="15" stroke-dashoffset="15" d="M12 3C16.9706 3 21 7.02944 21 12"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.3s" values="15;0"/><animateTransform attributeName="transform" dur="1.5s" repeatCount="indefinite" type="rotate" values="0 12 12;360 12 12"/></path></g></svg></div>')},onLoadSuccess:e=>{e&&$(e).find(".loading-wrap").remove()},onLoadFailure:e=>{e&&($(e).find(".loading-wrap svg").remove(),$(e).find(".loading-wrap").append('<svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path stroke-dasharray="60" stroke-dashoffset="60" d="M12 3L21 20H3L12 3Z"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.5s" values="60;0"/></path><path stroke-dasharray="6" stroke-dashoffset="6" d="M12 10V14"><animate fill="freeze" attributeName="stroke-dashoffset" begin="0.6s" dur="0.2s" values="6;0"/></path></g><circle cx="12" cy="17" r="1" fill="currentColor" fill-opacity="0"><animate fill="freeze" attributeName="fill-opacity" begin="0.8s" dur="0.4s" values="0;1"/></circle></svg>'),$(e).find(".loading-wrap").addClass("error"))},request:(n,a,o,d)=>{let l=3;utils.onLoading(n),function i(){new Promise((t,e)=>{let r=0,s=setTimeout(()=>{0===r&&(r=2,s=null,e("è¯·æ±‚è¶…æ—¶"),0==l)&&d()},5e3);fetch(a).then(function(e){if(2!==r&&(clearTimeout(s),t(e),s=null,r=1),e.ok)return e.json();throw new Error("Network response was not ok.")}).then(function(e){l=0,utils.onLoadSuccess(n),o(e)}).catch(function(e){0<l?(--l,setTimeout(()=>{i()},5e3)):(utils.onLoadFailure(n),d())})})}()},requestAnimationFrame:e=>{window.requestAnimationFrame||(window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame),window.requestAnimationFrame(e)},dark:{}};utils.dark.method={toggle:new RunItem},utils.dark=Object.assign(utils.dark,{push:utils.dark.method.toggle.push})</script><script>let sidebar={leftbar:()=>{l_body&&(l_body.toggleAttribute("leftbar"),l_body.removeAttribute("rightbar"))},rightbar:()=>{l_body&&(l_body.toggleAttribute("rightbar"),l_body.removeAttribute("leftbar"))},dismiss:()=>{l_body&&(l_body.removeAttribute("leftbar"),l_body.removeAttribute("rightbar"))},toggleTOC:()=>{document.querySelector("#data-toc").classList.toggle("collapse")}}</script><script>(()=>{var e;for(e of document.querySelectorAll(".tag-subtree.parent-tag > a > .tag-switcher-wrapper"))e.addEventListener("click",e=>{e.target.closest(".tag-subtree.parent-tag").classList.toggle("expanded"),e.preventDefault()});var t=new URLSearchParams(window.location.search).get("tag");if(t){let e=document.querySelector(`.tag-subtree[data-tag="${t}"]`);if(e)for(e.querySelector("a").classList.add("active");e;)e.classList.add("expanded"),e=e.parentElement.closest(".tag-subtree.parent-tag")}})()</script><script src="/js/main.js?v=1.30.1" defer></script><script>let applyTheme=e=>{"auto"===e?document.documentElement.removeAttribute("data-theme"):document.documentElement.setAttribute("data-theme",e),applyThemeToGiscus(e)},applyThemeToGiscus=e=>{e="auto"===e?"preferred_color_scheme":e;var t=document.getElementById("giscus"),t=(t&&t.setAttribute("data-theme",e),document.querySelector("#comments > section.giscus > iframe"));t&&(e=t.src.replace(/theme=[\w]+/,"theme="+e),t.src=e)},switchTheme=()=>{let e;switch(document.documentElement.getAttribute("data-theme")){case"light":e="dark";break;case"dark":e="auto";break;default:e="light"}applyTheme(e),window.localStorage.setItem("Stellar.theme",e),utils.dark.mode="auto"===e?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":e,utils.dark.method.toggle.start(),hud?.toast?.({light:"åˆ‡æ¢åˆ°æµ…è‰²æ¨¡å¼",dark:"åˆ‡æ¢åˆ°æ·±è‰²æ¨¡å¼",auto:"åˆ‡æ¢åˆ°è·Ÿéšç³»ç»Ÿé…è‰²"}[e])};(()=>{var e=window.localStorage.getItem("Stellar.theme");null!==e?applyTheme(e):utils.dark.mode=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",utils.dark.method.toggle.start()})()</script><script type="module">const el = document.querySelector('#comments #giscus');
  util.viewportLazyload(el, load_discus, false);

  function load_discus() {
    if (!el) return;
    try {
        el.innerHTML = '';
      } catch (error) {
        console.error(error);
      }
      const script = document.createElement('script');
      script.async = true;
      for (const key of Object.keys(el.attributes)) {
        const attr = el.attributes[key];
        if (['class', 'id'].includes(attr.name) === false) {
          script.setAttribute(attr.name, attr.value);
        }
      }
      el.appendChild(script);
  }</script><script defer>window.addEventListener("DOMContentLoaded",e=>{ctx.services=Object.assign({},JSON.parse('{"mdrender":{"js":"/js/services/mdrender.js"},"siteinfo":{"js":"/js/services/siteinfo.js","api":null},"ghinfo":{"js":"/js/services/ghinfo.js"},"sites":{"js":"/js/services/sites.js"},"friends":{"js":"/js/services/friends.js"},"friends_and_posts":{"js":"/js/services/friends_and_posts.js"},"timeline":{"js":"/js/services/timeline.js"},"fcircle":{"js":"/js/services/fcircle.js"},"weibo":{"js":"/js/services/weibo.js"},"memos":{"js":"/js/services/memos.js"},"voice":{"js":"/js/plugins/voice.js"},"video":{"js":"/js/plugins/video.js"},"download-file":{"js":"/js/plugins/download-file.js"},"twikoo":{"js":"/js/services/twikoo_latest_comment.js"},"waline":{"js":"/js/services/waline_latest_comment.js"},"artalk":{"js":"/js/services/artalk_latest_comment.js"},"giscus":{"js":"/js/services/giscus_latest_comment.js"}}'));for(let s of Object.keys(ctx.services)){let e=ctx.services[s].js;"siteinfo"==s?(ctx.cardlinks=document.querySelectorAll("a.link-card[cardlink]"),0<ctx.cardlinks?.length&&utils.js(e,{defer:!0}).then(function(){setCardLink(ctx.cardlinks)})):"voice"==s?(ctx.voiceAudios=document.querySelectorAll(".voice>audio"),0<ctx.voiceAudios?.length&&utils.js(e,{defer:!0}).then(function(){createVoiceDom(ctx.voiceAudios)})):"video"==s?(ctx.videos=document.querySelectorAll(".video>video"),0<ctx.videos?.length&&utils.js(e,{defer:!0}).then(function(){videoEvents(ctx.videos)})):"download-file"==s?(ctx.files=document.querySelectorAll(".file"),0<ctx.files?.length&&utils.js(e,{defer:!0}).then(function(){downloadFileEvent(ctx.files)})):0<document.getElementsByClassName("ds-"+s)?.length&&utils.jq(()=>{s,utils.js(deps.marked).then(function(){utils.js(e,{defer:!0})})})}let n=document.querySelectorAll(".chat .status-bar .time");var s,t;function i(){for(let e=0;e<n.length;++e){var s=n[e],t=new Date,i=t.getHours(),t=t.getMinutes();s.innerHTML=o(i)+":"+o(t)}}function o(e){return e<10?"0"+e:e}0<n.length&&(i(),s=(new Date).getSeconds(),t=setInterval(function(){i(),clearInterval(t),setInterval(i,6e4)},1e3*(60-s)));let c=new IntersectionObserver((e,t)=>{e.filter(e=>e.isIntersecting).sort((e,s)=>e.intersectionRect.y!==s.intersectionRect.y?e.intersectionRect.y-s.intersectionRect.y:e.intersectionRect.x-s.intersectionRect.x).forEach((e,s)=>{t.unobserve(e.target),setTimeout(()=>{e.target.classList.add("quote-blink"),setTimeout(()=>{e.target.classList.remove("quote-blink")},1e3)},Math.max(100,16)*(s+1))})}),r=document.querySelectorAll(".chat .talk .quote");r.forEach(i=>{i.addEventListener("click",function(){var e,s,t=document.getElementById("quote-"+i.getAttribute("quotedCellTag"));t&&(s=(e=t.parentElement).clientHeight/2,t.offsetTop>s-t.clientHeight/2?e.scrollTo({top:t.offsetTop-s+t.clientHeight/2,behavior:"smooth"}):e.scrollTo({top:0,behavior:"smooth"}),c.observe(t))})})})</script><script>window.addEventListener("DOMContentLoaded",e=>{ctx.search={path:"/search.json"},utils.js("/js/search/local-search.js",{defer:!0})})</script><script>window.FPConfig={delay:0,ignoreKeywords:[],maxRPS:5,hoverDelay:25}</script><script defer src="/js/flying-pages.min.js"></script><script defer src="/js/lazyload.min.js"></script><script>window.lazyLoadOptions={elements_selector:".lazy"},window.addEventListener("LazyLoad::Initialized",function(n){window.lazyLoadInstance=n.detail.instance},!1),document.addEventListener("DOMContentLoaded",function(){window.lazyLoadInstance?.update()})</script><script>ctx.fancybox={selector:"article.md-text img:not(.post-cover img):not(.cover img):not(.card-link img):not(.image-bg img):not(.social img):not(.preview img)",css:"/css/fancybox.min.css",js:"/js/fancybox.umd.min.js"};var selector="[data-fancybox]:not(.error)",needFancybox=(ctx.fancybox.selector&&(selector+=", "+ctx.fancybox.selector),0!==document.querySelectorAll(selector).length);if(!needFancybox){let e=document.getElementsByClassName("ds-memos");null!=e&&0<e.length&&(needFancybox=!0)}needFancybox&&(utils.css(ctx.fancybox.css),utils.js(ctx.fancybox.js,{defer:!0}).then(function(){Fancybox.bind(selector,{hideScrollbar:!1,Thumbs:{autoStart:!1},caption:(e,t)=>t.triggerEl.alt||t.triggerEl.dataset.caption||null})}))</script><script>window.addEventListener("DOMContentLoaded",e=>{let i=document.getElementById("swiper-api");null!=i&&(utils.css("/css/swiper-bundle.min.css"),utils.js("/js/swiper-bundle.min.js",{defer:!0}).then(function(){var e=i.getAttribute("effect")||"";new Swiper(".swiper#swiper-api",{slidesPerView:"auto",spaceBetween:8,centeredSlides:!0,effect:e,rewind:!0,pagination:{el:".swiper-pagination",clickable:!0},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}})}))})</script><script>document.addEventListener("DOMContentLoaded",function(){window.codeElements=document.querySelectorAll(".code"),0<window.codeElements.length&&(ctx.copycode={default_text:"å¤åˆ¶ä»£ç ",success_text:"å¤åˆ¶æˆåŠŸ",toast:"å¤åˆ¶æˆåŠŸ"},utils.js("/js/plugins/copycode.js"))})</script><script async>((a,t,c)=>{t.ChatraID="PHWnu7Bamcwtbnx2d";var h=a.createElement("script");t[c]=t[c]||function(){(t[c].q=t[c].q||[]).push(arguments)},h.async=!0,h.src="https://call.chatra.io/chatra.js",a.head&&a.head.appendChild(h)})(document,window,"Chatra")</script><script defer src="https://cn.vercount.one/js"></script><link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" as="style" onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous"></noscript><script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous" onload="renderMathInElement(document.body)"></script><script>window.va=window.va||function(){(window.vaq=window.vaq||[]).push(arguments)}</script><script defer src="/_vercel/insights/script.js"></script><script>window.si=window.si||function(){(window.siq=window.siq||[]).push(arguments)}</script><script defer src="/_vercel/speed-insights/script.js"></script><script>function change_banner(){$(".banner img.bg").attr("src","/assets/banner/banner_"+Math.floor(20*Math.random()+1)+".jpg")}setTimeout("change_banner()",250)</script><script>function add_page_pv(){$("#post-meta").after('<div class="flex-row" id="post-meta"><span class="text created">æœ¬æ–‡æ€»é˜…è¯»é‡ <span id="vercount_value_page_pv"></span> æ¬¡</span></div>')}setTimeout("add_page_pv()",500)</script><script>function change_img_alt(){$("article.md-text img:not(.post-cover img):not(.cover img):not(.card-link img):not(.image-bg img):not(.social img):not(.preview img)").each(function(t){$(this).after("<div class='image-meta' style='text-align:center;'><span class='image-caption center' style='display:inline-block;font-size:.8125rem;color:var(--text-p2);line-height:1.5;text-align:justify;'>"+($(this).attr("title")||$(this).attr("alt"))+"</span></div>")})}setTimeout("change_img_alt()",1e3)</script></div></body></html>